<!DOCTYPE html><html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=contain"><title>A simple deep learning model for stock price prediction using TensorFlow</title><link rel="canonical" href="https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877"><meta name="title" content="A simple deep learning model for stock price prediction using TensorFlow"><meta name="referrer" content="unsafe-url"><meta name="description" content="For a recent hackathon that we did at STATWORX, some of our team members scraped minutely S&amp;P 500 data from the Google Finance API. The data consisted of index as well as stock prices of the S&amp;P’s…"><meta name="theme-color" content="#000000"><meta property="og:title" content="A simple deep learning model for stock price prediction using TensorFlow"><meta property="twitter:title" content="A simple deep learning model for stock price prediction using TensorFlow"><meta property="og:url" content="https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="For a recent hackathon that we did at STATWORX, some of our team members scraped minutely S&amp;P 500 data from the Google Finance API. The…"><meta name="twitter:description" content="For a recent hackathon that we did at STATWORX, some of our team members scraped minutely S&amp;P 500 data from the Google Finance API. The…"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg"><link rel="author" href="https://medium.com/@STATWORX"><meta name="author" content="Sebastian Heinz"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="https://medium.com/@STATWORX"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2017-11-09T15:07:55.166Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="13 min read"><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/30505541d877"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/30505541d877"><meta property="al:android:url" content="medium://p/30505541d877"><meta property="al:web:url" content="https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml" /><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/30505541d877" /><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1920,"height":1440,"url":"https://cdn-images-1.medium.com/max/2600/1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg"},"url":"https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877","dateCreated":"2017-11-09T15:07:55.166Z","datePublished":"2017-11-09T15:07:55.166Z","dateModified":"2018-10-08T19:10:12.449Z","headline":"A simple deep learning model for stock price prediction using TensorFlow","name":"A simple deep learning model for stock price prediction using TensorFlow","articleId":"30505541d877","thumbnailUrl":"https://cdn-images-1.medium.com/max/2600/1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg","keywords":["Tag:Machine Learning","Tag:Deep Learning","Tag:TensorFlow","Tag:Stock Market","Tag:Tutorial","Publication:mlreview","LockedPostSource:0","Elevated:false","LayerCake:4"],"author":{"@type":"Person","name":"Sebastian Heinz","url":"https://medium.com/@STATWORX"},"creator":["Sebastian Heinz"],"publisher":{"@type":"Organization","name":"ML Review","url":"https://medium.com/mlreview","logo":{"@type":"ImageObject","width":133,"height":60,"url":"https://cdn-images-1.medium.com/max/266/1*0ykYC2ubehxNL5XrIIbscg.png"}},"mainEntityOfPage":"https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877"}</script><meta name="parsely-link" content="https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877"><link rel="stylesheet" type="text/css" class="js-glyph-" id="glyph-8" href="https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css" /><link rel="stylesheet" href="https://cdn-static-1.medium.com/_/fp/css/main-branding-base.tcUUUzQ2VpR_H2vWPHs61w.css"><script>!function(n,e){var t,o,i,c=[],f={passive:!0,capture:!0},r=new Date,a="pointerup",u="pointercancel";function p(n,c){t||(t=c,o=n,i=new Date,w(e),s())}function s(){o>=0&&o<i-r&&(c.forEach(function(n){n(o,t)}),c=[])}function l(t){if(t.cancelable){var o=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;"pointerdown"==t.type?function(t,o){function i(){p(t,o),r()}function c(){r()}function r(){e(a,i,f),e(u,c,f)}n(a,i,f),n(u,c,f)}(o,t):p(o,t)}}function w(n){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(e){n(e,l,f)})}w(n),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){c.push(n),s()}}(addEventListener,removeEventListener);</script><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date; ga("create", "UA-24232453-2", "auto", {"allowLinker": true, "legacyCookieDomain": window.location.hostname}); ga("send", "pageview");</script><script async src="https://www.google-analytics.com/analytics.js"></script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*3yjjoZ--eh8E84rH1xRIhQ.jpeg"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*3yjjoZ--eh8E84rH1xRIhQ.jpeg"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*3yjjoZ--eh8E84rH1xRIhQ.jpeg"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/120/120/1*3yjjoZ--eh8E84rH1xRIhQ.jpeg"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"></head><body itemscope class=" postShowScreen browser-safari os-mac is-withMagicUnderlines v-glyph v-glyph--m2 is-noJs"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main" id="container"><div class="butterBar butterBar--error"></div><div class="surface"><div id="prerendered" class="screenContent"><canvas class="canvas-renderer"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"></div><div class="metabar u-clearfix u-boxShadow4px12pxBlackLighter u-textColorTransparentWhiteDarker js-metabar"><div class="branch-journeys-top"></div><div class="js-metabarMiddle metabar-inner u-marginAuto u-maxWidth1032 u-flexCenter u-justifyContentSpaceBetween u-height65 u-xs-height56 u-paddingHorizontal20"><div class="metabar-block u-flex1 u-flexCenter"><div class="u-xs-hide js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45" ><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="u-xs-show js-metabarLogoLeft"><a href="https://medium.com/" data-log-event="home" class="siteNav-logo u-fillTransparentBlackDarker u-flex0 u-flexCenter u-paddingTop0"><span class="svgIcon svgIcon--logoMonogram svgIcon--45px is-flushLeft u-flex0 u-flexCenter u-paddingTop0"><svg class="svgIcon-use" width="45" height="45" ><path d="M5 40V5h35v35H5zm8.56-12.627c0 .555-.027.687-.318 1.03l-2.457 2.985v.396h6.974v-.396l-2.456-2.985c-.291-.343-.344-.502-.344-1.03V18.42l6.127 13.364h.714l5.256-13.364v10.644c0 .29 0 .342-.185.528l-1.848 1.796v.396h9.19v-.396l-1.822-1.796c-.184-.186-.21-.238-.21-.528V15.937c0-.291.026-.344.21-.528l1.823-1.797v-.396h-6.471l-4.622 11.542-5.203-11.542h-6.79v.396l2.14 2.64c.239.292.291.37.291.768v10.353z"/></svg></span><span class="u-textScreenReader">Homepage</span></a></div></div><div class="metabar-block u-flex0 u-flexCenter"><div class="u-flexCenter u-height65 u-xs-height56"><div class="buttonSet buttonSet--wide u-lineHeightInherit"><label class="button button--small button--chromeless button--withIcon button--withSvgIcon inputGroup u-sm-hide metabar-predictiveSearch u-baseColor--buttonNormal u-baseColor--placeholderNormal" title="Search ML Review"><span class="svgIcon svgIcon--search svgIcon--25px u-baseColor--iconLight"><svg class="svgIcon-use" width="25" height="25" ><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"/></svg></span><input class="js-predictiveSearchInput textInput textInput--rounded textInput--darkText u-baseColor--textNormal textInput--transparent" type="search" placeholder="Search ML Review" required="true" data-collection-id="33272dbbd858" /></label><a class="button button--small button--chromeless u-sm-show is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--chromeless u-xs-top1"   href="https://medium.com/mlreview/search" title="Search" aria-label="Search"><span class="button-defaultState"><span class="svgIcon svgIcon--search svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" ><path d="M20.067 18.933l-4.157-4.157a6 6 0 1 0-.884.884l4.157 4.157a.624.624 0 1 0 .884-.884zM6.5 11c0-2.62 2.13-4.75 4.75-4.75S16 8.38 16 11s-2.13 4.75-4.75 4.75S6.5 13.62 6.5 11z"/></svg></span></span></a><button class="button button--small button--chromeless is-inSiteNavBar u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--activity js-notificationsButton u-marginRight16 u-xs-marginRight10 u-lineHeight0 u-size25x25"  title="Notifications" aria-label="Notifications" data-action="open-notifications"><span class="svgIcon svgIcon--bell svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"  viewBox="-293 409 25 25"><path d="M-273.327 423.67l-1.673-1.52v-3.646a5.5 5.5 0 0 0-6.04-5.474c-2.86.273-4.96 2.838-4.96 5.71v3.41l-1.68 1.553c-.204.19-.32.456-.32.734V427a1 1 0 0 0 1 1h3.49a3.079 3.079 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59c0-.28-.12-.55-.327-.74zm-7.173 5.63c-.842 0-1.55-.546-1.812-1.3h3.624a1.92 1.92 0 0 1-1.812 1.3zm6.35-2.45h-12.7v-2.347l1.63-1.51c.236-.216.37-.522.37-.843v-3.41c0-2.35 1.72-4.356 3.92-4.565a4.353 4.353 0 0 1 4.78 4.33v3.645c0 .324.137.633.376.85l1.624 1.477v2.373z"/></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal is-inSiteNavBar js-userActions"  aria-haspopup="true" data-action="open-userActions"><div class="avatar"><img  src="https://cdn-images-1.medium.com/fit/c/64/64/0*4SEFINyUW8jmBVrV." class="avatar-image avatar-image--icon" alt="Milad amir Toutounchian"></div></button></div></div></div></div><div class="u-tintBgColor u-tintSpectrum " ><div class="metabar-inner u-marginAuto u-maxWidth1032 u-paddingHorizontal20 js-metabarBottom"><nav role="navigation" class="metabar-block metabar-block--below u-flexCenter u-overflowHidden u-height54"><div class="u-flexCenter u-overflowHidden"><div class="u-marginRight40"><a href="https://medium.com/mlreview?source=logo-c76ae1d30db3---33272dbbd858" class="u-flexCenter js-collectionLogoOrName"><img height="36" width="80" src="https://cdn-images-1.medium.com/letterbox/160/72/50/50/1*0ykYC2ubehxNL5XrIIbscg.png?source=logoAvatar-c76ae1d30db3---33272dbbd858" alt="ML Review" /></a></div><div class="u-overflowHidden u-xs-hide"><ul class="u-textAlignLeft u-noWrap u-overflowX u-height80 u-marginTop40 js-collectionNavItems"><li class="metabar-navItem js-collectionNavItem u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10"><a class="link link--darken u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink"   href="https://medium.com/mlreview/publish-with-ml-review-c814c54ca28d">✍️ Contribute</a></li><span class="u-borderLeft1 u-baseColor--borderLight"></span><li class="metabar-navItem js-collectionNavItem is-external u-inlineBlock u-fontSize13 u-textUppercase u-letterSpacing1px u-textColorNormal u-xs-paddingRight12 u-xs-marginRight0 u-xs-paddingTop10"><a class="link link--darkenOnHover u-accentColor--textDarken link--noUnderline u-baseColor--link js-navItemLink"   href="http://mlreview.com/?medium" rel="nofollow noopener" target="_blank">🔥𝐌𝐋Review.com Newsletter</a></li></ul></div></div></nav></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-tintBgColor  u-height119 u-xs-height110"></div><main role="main"><article class=" u-minHeight100vhOffset65 u-overflowHidden postArticle postArticle--full is-withAccentColors is-withLeadingImage"  lang="en"><div class="postArticle-content js-postField js-notesSource js-trackPostScrolls"  data-post-id="30505541d877" data-source="post_page" data-collection-id="33272dbbd858" data-tracking-context="postPage"><section name="acc5" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--fullWidth"><figure name="6654" id="6654" class="graf graf--figure graf--layoutFillWidth graf--leading"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg" data-width="4608" data-height="3456" data-is-featured="true"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/2600/1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/2600/1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg"></noscript></div></div><figcaption class="imageCaption">A typical stock image when you search for stock market prediction ;)</figcaption></figure></div><div class="section-inner sectionLayout--insetColumn"><h1 name="d0fa" id="d0fa" class="graf graf--h3 graf-after--figure graf--title">A simple deep learning model for stock price prediction using TensorFlow</h1><div class="uiScale uiScale-ui--regular uiScale-caption--regular u-flexCenter u-marginVertical24 u-fontSize15 js-postMetaLockup"><div class="u-flex0"><a class="link u-baseColor--link avatar"   href="https://medium.com/@STATWORX?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="1165a0d0d97e" data-action-type="hover" data-user-id="1165a0d0d97e" dir="auto"><img  src="https://cdn-images-1.medium.com/fit/c/100/100/1*8lHWKHMXnJJDjMmFaLSFTA.jpeg" class="avatar-image u-size50x50" alt="Go to the profile of Sebastian Heinz"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><div class="u-paddingBottom3"><a class="ds-link ds-link--styleSubtle ui-captionStrong u-inlineBlock link link--darken link--darker"   href="https://medium.com/@STATWORX" data-action="show-user-card" data-action-value="1165a0d0d97e" data-action-type="hover" data-user-id="1165a0d0d97e" dir="auto">Sebastian Heinz</a><span class="followState js-followState" data-user-id="1165a0d0d97e"><button class="button button--smallest u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-xs-hide"  data-action="toggle-block-user" data-action-value="1165a0d0d97e" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--smallest button--dark u-noUserSelect button--withChrome u-accentColor--buttonDark button--follow js-followButton u-marginLeft10 u-xs-hide"  data-action="toggle-subscribe-user" data-action-value="1165a0d0d97e" data-action-source="post_header_lockup-1165a0d0d97e-------------------------follow_byline" data-subscribe-source="post_header_lockup" data-follow-context-entity-id="30505541d877"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="ui-caption u-noWrapWithEllipsis js-testPostMetaInlineSupplemental"><time datetime="2017-11-09T15:07:55.166Z">Nov 9, 2017</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="13 min read"></span></div></div></div><p name="3d3b" id="3d3b" class="graf graf--p graf-after--h3">For a recent hackathon that we did at <a href="https://www.statworx.com/de/data-science/" data-href="https://www.statworx.com/de/data-science/" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">STATWORX</a>, some of our team members scraped minutely S&amp;P 500 data from the Google Finance API. The data consisted of index as well as stock prices of the S&amp;P’s 500 constituents. Having this data at hand, the idea of developing a deep learning model for predicting the S&amp;P 500 index based on the 500 constituents prices one minute ago came immediately on my mind.</p><p name="6b9f" id="6b9f" class="graf graf--p graf-after--p">Playing around with the data and building the deep learning model with TensorFlow was fun and so I decided to write my first Medium.com story: a little TensorFlow tutorial on predicting S&amp;P 500 stock prices. What you will read is not an in-depth tutorial, but more a high-level introduction to the important building blocks and concepts of TensorFlow models. The Python code I’ve created is not optimized for efficiency but understandability. The dataset I’ve used can be downloaded from <a href="http://files.statworx.com/sp500.zip" data-href="http://files.statworx.com/sp500.zip" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">here</a> (40MB).</p><blockquote name="4293" id="4293" class="graf graf--blockquote graf-after--p">Note, that this story is a hands-on tutorial on TensorFlow. Actual prediction of stock prices is a really challenging and complex task that requires tremendous efforts, especially at higher frequencies, such as minutes used here.</blockquote><h4 name="f01e" id="f01e" class="graf graf--h4 graf-after--blockquote">Importing and preparing the data</h4><p name="65cc" id="65cc" class="graf graf--p graf-after--h4">Our team exported the scraped stock data from our scraping server as a csv file. The dataset contains <code class="markup--code markup--p-code">n = 41266</code> minutes of data ranging from April to August 2017 on 500 stocks as well as the total S&amp;P 500 index price. Index and stocks are arranged in wide format.</p><pre name="23d4" id="23d4" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Import data<br>data = pd.read_csv(&#39;data_stocks.csv&#39;)</code></pre><pre name="3ca9" id="3ca9" class="graf graf--pre graf-after--pre"># Drop date variable<br>data = data.drop([&#39;DATE&#39;], 1)</pre><pre name="9b83" id="9b83" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># Dimensions of dataset<br>n = data.shape[0]<br>p = data.shape[1]</code></pre><pre name="6707" id="6707" class="graf graf--pre graf-after--pre"># Make data a numpy array<br>data = data.values</pre><p name="a044" id="a044" class="graf graf--p graf-after--pre">The data was already cleaned and prepared, meaning missing stock and index prices were LOCF’ed (last observation carried forward), so that the file did not contain any missing values.</p><p name="f896" id="f896" class="graf graf--p graf-after--p">A quick look at the S&amp;P time series using <code class="markup--code markup--p-code">pyplot.plot(data[&#39;SP500&#39;])</code>:</p><figure name="6913" id="6913" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*OK6YP4-xG5v8oakDXk2oDw.png" src="https://cdn-images-1.medium.com/max/1600/1*OK6YP4-xG5v8oakDXk2oDw.png"></div><figcaption class="imageCaption">Time series plot of the S&amp;P 500 index.</figcaption></figure><blockquote name="cd8e" id="cd8e" class="graf graf--blockquote graf-after--figure">Note: This is actually the lead of the S&amp;P 500 index, meaning, its value is shifted 1 minute into the future (this has already been done in the dataset). This operation is necessary since we want to predict the next minute of the index and not the current minute. Technically speaking, each row in the dataset contains the price of the S&amp;P500 at t+1 and the constituent’s prices at T=t.</blockquote><h4 name="f378" id="f378" class="graf graf--h4 graf-after--blockquote">Preparing training and test data</h4><p name="a38b" id="a38b" class="graf graf--p graf-after--h4">The dataset was split into training and test data. The training data contained 80% of the total dataset. The data was not shuffled but sequentially sliced. The training data ranges from April to approx. end of July 2017, the test data ends end of August 2017.</p><pre name="05c3" id="05c3" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Training and test data<br>train_start = 0<br>train_end = int(np.floor(0.8*n))<br>test_start = train_end<br>test_end = n<br>data_train = data[np.arange(train_start, train_end), :]<br>data_test = data[np.arange(test_start, test_end), :]</code></pre><p name="5631" id="5631" class="graf graf--p graf-after--pre">There are a lot of different approaches to time series cross validation, such as rolling forecasts with and without refitting or more elaborate concepts such as time series bootstrap resampling. The latter involves repeated samples from the remainder of the seasonal decomposition of the time series in order to simulate samples that follow the same seasonal pattern as the original time series but are not exact copies of its values.</p><h4 name="1753" id="1753" class="graf graf--h4 graf-after--p">Data scaling</h4><p name="04ab" id="04ab" class="graf graf--p graf-after--h4">Most neural network architectures benefit from scaling the inputs (sometimes also the output). Why? Because most common activation functions of the network’s neurons such as tanh or sigmoid are defined on the <code class="markup--code markup--p-code">[-1, 1]</code> or <code class="markup--code markup--p-code">[0, 1]</code> interval respectively. Nowadays, rectified linear unit (ReLU) activations are commonly used activations which are unbounded on the axis of possible activation values. However, we will scale both the inputs and targets anyway. Scaling can be easily accomplished in Python using sklearn’s <code class="markup--code markup--p-code">MinMaxScaler</code>.</p><pre name="503f" id="503f" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Scale data<br>from sklearn.preprocessing import MinMaxScaler<br>scaler = MinMaxScaler()<br>data_train = scaler.fit_transform(data_train)<br>data_test = scaler.transform(data_test)</code></pre><pre name="a5ac" id="a5ac" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># Build X and y<br>X_train = data_train[:, 1:]<br>y_train = data_train[:, 0]<br>X_test = data_test[:, 1:]<br>y_test = data_test[:, 0]</code></pre><p name="5df4" id="5df4" class="graf graf--p graf-after--pre">Remark: Caution must be undertaken regarding <em class="markup--em markup--p-em">what</em> part of the data is scaled and <em class="markup--em markup--p-em">when</em>. A common mistake is to scale the whole dataset before training and test split are being applied. Why is this a mistake? Because scaling invokes the calculation of statistics e.g. the min/max of a variable. When performing time series forecasting in real life, you do not have information from future observations at the time of forecasting. Therefore, calculation of scaling statistics has to be conducted on training data and must then be applied to the test data. Otherwise, you use future information at the time of forecasting which commonly biases forecasting metrics in a positive direction.</p><h4 name="9dd3" id="9dd3" class="graf graf--h4 graf-after--p">Introduction to TensorFlow</h4><p name="185d" id="185d" class="graf graf--p graf-after--h4">TensorFlow is a great piece of software and currently the leading deep learning and neural network computation framework. It is based on a <code class="markup--code markup--p-code">C++</code> low level backend but is usually controlled via Python (there is also a neat <a href="https://tensorflow.rstudio.com/" data-href="https://tensorflow.rstudio.com/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">TensorFlow library for R</a>, maintained by RStudio). TensorFlow operates on a graph representation of the underlying computational task. This approach allows the user to specify mathematical operations as elements in a graph of data, variables and operators. Since neural networks are actually graphs of data and mathematical operations, TensorFlow is just perfect for neural networks and deep learning. Check out this simple example (stolen from our <a href="https://www.statworx.com/ch/blog/deep-learning-teil-2-programmierung/" data-href="https://www.statworx.com/ch/blog/deep-learning-teil-2-programmierung/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">deep learning introduction</a> from our blog):</p><figure name="08b3" id="08b3" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder"><img class="graf-image" data-image-id="1*aCqfu5QVufgPuJNWg4Vn7g.png" src="https://cdn-images-1.medium.com/max/1600/1*aCqfu5QVufgPuJNWg4Vn7g.png"></div><figcaption class="imageCaption">A very simple graph that adds two numbers together.</figcaption></figure><p name="147a" id="147a" class="graf graf--p graf-after--figure">In the figure above, two numbers are supposed to be added. Those numbers are stored in two variables, <code class="markup--code markup--p-code">a</code> and <code class="markup--code markup--p-code">b</code>. The two values are flowing through the graph and arrive at the square node, where they are being added. The result of the addition is stored into another variable, <code class="markup--code markup--p-code">c</code>. Actually, <code class="markup--code markup--p-code">a</code>, <code class="markup--code markup--p-code">b</code> and <code class="markup--code markup--p-code">c</code> can be considered as placeholders. Any numbers that are fed into <code class="markup--code markup--p-code">a</code> and <code class="markup--code markup--p-code">b</code> get added and are stored into <code class="markup--code markup--p-code">c</code>. This is exactly how TensorFlow works. The user defines an abstract representation of the model (neural network) through placeholders and variables. Afterwards, the placeholders get &quot;filled&quot; with real data and the actual computations take place. The following code implements the toy example from above in TensorFlow:</p><pre name="dd3a" id="dd3a" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Import TensorFlow<br>import tensorflow as tf<br><br># Define a and b as placeholders<br>a = tf.placeholder(dtype=tf.int8)<br>b = tf.placeholder(dtype=tf.int8)<br><br># Define the addition<br>c = tf.add(a, b)<br><br># Initialize the graph<br>graph = tf.Session()<br><br># Run the graph<br>graph.run(c, feed_dict={a: 5, b: 4})</code></pre><p name="5c17" id="5c17" class="graf graf--p graf-after--pre">After having imported the TensorFlow library, two placeholders are defined using <code class="markup--code markup--p-code">tf.placeholder()</code>. They correspond to the two blue circles on the left of the image above. Afterwards, the mathematical addition is defined via <code class="markup--code markup--p-code">tf.add()</code>. The result of the computation is <code class="markup--code markup--p-code">c = 9</code>. With placeholders set up, the graph can be executed with any integer value for <code class="markup--code markup--p-code">a</code> and <code class="markup--code markup--p-code">b</code>. Of course, the former problem is just a toy example. The required graphs and computations in a neural network are much more complex.</p><h4 name="de5e" id="de5e" class="graf graf--h4 graf-after--p">Placeholders</h4><p name="92fb" id="92fb" class="graf graf--p graf-after--h4">As mentioned before, it all starts with placeholders. We need two placeholders in order to fit our model: <code class="markup--code markup--p-code">X</code> contains the network&#39;s inputs (the stock prices of all S&amp;P 500 constituents at time <code class="markup--code markup--p-code">T = t</code>) and Y the network&#39;s outputs (the index value of the S&amp;P 500 at time <code class="markup--code markup--p-code">T = t + 1</code>).</p><p name="ee93" id="ee93" class="graf graf--p graf-after--p">The shape of the placeholders correspond to <code class="markup--code markup--p-code">[None, n_stocks]</code> with <code class="markup--code markup--p-code">[None]</code> meaning that the inputs are a 2-dimensional matrix and the outputs are a 1-dimensional vector. It is crucial to understand which input and output dimensions the neural net needs in order to design it properly.</p><pre name="a78c" id="a78c" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Placeholder<br>X = tf.placeholder(dtype=tf.float32, shape=[None, n_stocks])<br>Y = tf.placeholder(dtype=tf.float32, shape=[None])</code></pre><p name="e7e9" id="e7e9" class="graf graf--p graf-after--pre">The <code class="markup--code markup--p-code">None</code> argument indicates that at this point we do not yet know the number of observations that flow through the neural net graph in each batch, so we keep if flexible. We will later define the variable <code class="markup--code markup--p-code">batch_size</code> that controls the number of observations per training batch.</p><h4 name="5932" id="5932" class="graf graf--h4 graf-after--p">Variables</h4><p name="03ce" id="03ce" class="graf graf--p graf-after--h4">Besides placeholders, variables are another cornerstone of the TensorFlow universe. While placeholders are used to store input and target data in the graph, variables are used as flexible containers within the graph that are allowed to change during graph execution. Weights and biases are represented as variables in order to adapt during training. Variables need to be initialized, prior to model training. We will get into that a litte later in more detail.</p><p name="c376" id="c376" class="graf graf--p graf-after--p">The model consists of four hidden layers. The first layer contains 1024 neurons, slightly more than double the size of the inputs. Subsequent hidden layers are always half the size of the previous layer, which means 512, 256 and finally 128 neurons. A reduction of the number of neurons for each subsequent layer compresses the information the network identifies in the previous layers. Of course, other network architectures and neuron configurations are possible but are out of scope for this introduction level article.</p><pre name="09b5" id="09b5" class="graf graf--pre graf-after--p"># Model architecture parameters<br>n_stocks = 500<br>n_neurons_1 = 1024<br>n_neurons_2 = 512<br>n_neurons_3 = 256<br>n_neurons_4 = 128<br>n_target = 1</pre><pre name="f8ea" id="f8ea" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># Layer 1: Variables for hidden weights and biases<br>W_hidden_1 = tf.Variable(weight_initializer([n_stocks, n_neurons_1]))<br>bias_hidden_1 = tf.Variable(bias_initializer([n_neurons_1]))</code></pre><pre name="3211" id="3211" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># Layer 2: Variables for hidden weights and biases<br>W_hidden_2 = tf.Variable(weight_initializer([n_neurons_1, n_neurons_2]))<br>bias_hidden_2 = tf.Variable(bias_initializer([n_neurons_2]))</code></pre><pre name="4cc0" id="4cc0" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># Layer 3: Variables for hidden weights and biases<br>W_hidden_3 = tf.Variable(weight_initializer([n_neurons_2, n_neurons_3]))<br>bias_hidden_3 = tf.Variable(bias_initializer([n_neurons_3]))</code></pre><pre name="e087" id="e087" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># Layer 4: Variables for hidden weights and biases<br>W_hidden_4 = tf.Variable(weight_initializer([n_neurons_3, n_neurons_4]))<br>bias_hidden_4 = tf.Variable(bias_initializer([n_neurons_4]))<br><br># Output layer: Variables for output weights and biases<br>W_out = tf.Variable(weight_initializer([n_neurons_4, n_target]))<br>bias_out = tf.Variable(bias_initializer([n_target]))</code></pre><p name="e1cf" id="e1cf" class="graf graf--p graf-after--pre">It is important to understand the required variable dimensions between input, hidden and output layers. As a rule of thumb in multilayer perceptrons (MLPs, the type of networks used here), the second dimension of the previous layer is the first dimension in the current layer for weight matrices. This might sound complicated but is essentially just each layer passing its output as input to the next layer. The biases dimension equals the second dimension of the current layer’s weight matrix, which corresponds the number of neurons in this layer.</p><h4 name="765d" id="765d" class="graf graf--h4 graf-after--p">Designing the network architecture</h4><p name="25ab" id="25ab" class="graf graf--p graf-after--h4">After definition of the required weight and bias variables, the network topology, the architecture of the network, needs to be specified. Hereby, placeholders (data) and variables (weighs and biases) need to be combined into a system of sequential matrix multiplications.</p><p name="6631" id="6631" class="graf graf--p graf-after--p">Furthermore, the hidden layers of the network are transformed by activation functions. Activation functions are important elements of the network architecture since they introduce non-linearity to the system. There are dozens of possible activation functions out there, one of the most common is the rectified linear unit (ReLU) which will also be used in this model.</p><pre name="8da6" id="8da6" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Hidden layer<br>hidden_1 = tf.nn.relu(tf.add(tf.matmul(X, W_hidden_1), bias_hidden_1))<br>hidden_2 = tf.nn.relu(tf.add(tf.matmul(hidden_1, W_hidden_2), bias_hidden_2))<br>hidden_3 = tf.nn.relu(tf.add(tf.matmul(hidden_2, W_hidden_3), bias_hidden_3))<br>hidden_4 = tf.nn.relu(tf.add(tf.matmul(hidden_3, W_hidden_4), bias_hidden_4))<br><br># Output layer (must be transposed)<br>out = tf.transpose(tf.add(tf.matmul(hidden_4, W_out), bias_out))</code></pre><p name="1020" id="1020" class="graf graf--p graf-after--pre">The image below illustrates the network architecture. The model consists of three major building blocks. The input layer, the hidden layers and the output layer. This architecture is called a feedforward network. Feedforward indicates that the batch of data solely flows from left to right. Other network architectures, such as recurrent neural networks, also allow data flowing “backwards” in the network.</p><figure name="6564" id="6564" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 413px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 58.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*SHAol6IyUGn5yoXt7mC4Uw.png" data-width="1629" data-height="960" data-action="zoom" data-action-value="1*SHAol6IyUGn5yoXt7mC4Uw.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*SHAol6IyUGn5yoXt7mC4Uw.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*SHAol6IyUGn5yoXt7mC4Uw.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*SHAol6IyUGn5yoXt7mC4Uw.png"></noscript></div></div><figcaption class="imageCaption">Cool technical illustration of our feedforward network architecture.</figcaption></figure><h4 name="9d7e" id="9d7e" class="graf graf--h4 graf-after--figure">Cost function</h4><p name="f6d7" id="f6d7" class="graf graf--p graf-after--h4">The cost function of the network is used to generate a measure of deviation between the network’s predictions and the actual observed training targets. For regression problems, the mean squared error (MSE) function is commonly used. MSE computes the average squared deviation between predictions and targets. Basically, any differentiable function can be implemented in order to compute a deviation measure between predictions and targets.</p><pre name="4a52" id="4a52" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Cost function<br>mse = tf.reduce_mean(tf.squared_difference(out, Y))</code></pre><p name="6784" id="6784" class="graf graf--p graf-after--pre">However, the MSE exhibits certain properties that are advantageous for the general optimization problem to be solved.</p><h4 name="ebe7" id="ebe7" class="graf graf--h4 graf-after--p">Optimizer</h4><p name="b294" id="b294" class="graf graf--p graf-after--h4">The optimizer takes care of the necessary computations that are used to adapt the network’s weight and bias variables during training. Those computations invoke the calculation of so called gradients, that indicate the direction in which the weights and biases have to be changed during training in order to minimize the network’s cost function. The development of stable and speedy optimizers is a major field in neural network an deep learning research.</p><pre name="8003" id="8003" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Optimizer<br>opt = tf.train.AdamOptimizer().minimize(mse)</code></pre><p name="9d4a" id="9d4a" class="graf graf--p graf-after--pre">Here the Adam Optimizer is used, which is one of the current default optimizers in deep learning development. Adam stands for “<strong class="markup--strong markup--p-strong">Ada</strong>ptive <strong class="markup--strong markup--p-strong">M</strong>oment Estimation” and can be considered as a combination between two other popular optimizers AdaGrad and RMSProp.</p><h4 name="1b4f" id="1b4f" class="graf graf--h4 graf-after--p">Initializers</h4><p name="3d87" id="3d87" class="graf graf--p graf-after--h4">Initializers are used to initialize the network’s variables before training. Since neural networks are trained using numerical optimization techniques, the starting point of the optimization problem is one the key factors to find good solutions to the underlying problem. There are different initializers available in TensorFlow, each with different initialization approaches. Here, I use the <code class="markup--code markup--p-code">tf.variance_scaling_initializer()</code>, which is one of the default initialization strategies.</p><pre name="2765" id="2765" class="graf graf--pre graf-after--p"><code class="markup--code markup--pre-code"># Initializers<br>sigma = 1<br>weight_initializer = tf.variance_scaling_initializer(mode=&quot;fan_avg&quot;, distribution=&quot;uniform&quot;, scale=sigma)<br>bias_initializer = tf.zeros_initializer()</code></pre><p name="de81" id="de81" class="graf graf--p graf-after--pre">Note, that with TensorFlow it is possible to define multiple initialization functions for different variables within the graph. However, in most cases, a unified initialization is sufficient.</p><h4 name="793c" id="793c" class="graf graf--h4 graf-after--p">Fitting the neural network</h4><p name="107c" id="107c" class="graf graf--p graf-after--h4">After having defined the placeholders, variables, initializers, cost functions and optimizers of the network, the model needs to be trained. Usually, this is done by minibatch training. During minibatch training random data samples of <code class="markup--code markup--p-code">n = batch_size</code> are drawn from the training data and fed into the network. The training dataset gets divided into <code class="markup--code markup--p-code">n / batch_size</code> batches that are sequentially fed into the network. At this point the placeholders <code class="markup--code markup--p-code">X</code> and <code class="markup--code markup--p-code">Y</code> come into play. They store the input and target data and present them to the network as inputs and targets.</p><p name="2011" id="2011" class="graf graf--p graf-after--p">A sampled data batch of <code class="markup--code markup--p-code">X</code> flows through the network until it reaches the output layer. There, TensorFlow compares the models predictions against the actual observed targets <code class="markup--code markup--p-code">Y</code> in the current batch. Afterwards, TensorFlow conducts an optimization step and updates the networks parameters, corresponding to the selected learning scheme. After having updated the weights and biases, the next batch is sampled and the process repeats itself. The procedure continues until all batches have been presented to the network. One full sweep over all batches is called an epoch.</p><p name="2f16" id="2f16" class="graf graf--p graf-after--p">The training of the network stops once the maximum number of epochs is reached or another stopping criterion defined by the user applies.</p><pre name="c125" id="c125" class="graf graf--pre graf-after--p"># Make Session<br>net = tf.Session()</pre><pre name="a0a9" id="a0a9" class="graf graf--pre graf-after--pre"><code class="markup--code markup--pre-code"># Run initializer<br>net.run(tf.global_variables_initializer())<br><br># Setup interactive plot<br>plt.ion()<br>fig = plt.figure()<br>ax1 = fig.add_subplot(111)<br>line1, = ax1.plot(y_test)<br>line2, = ax1.plot(y_test*0.5)<br>plt.show()<br><br># Number of epochs and batch size<br>epochs = 10<br>batch_size = 256<br><br></code>for e in range(epochs):<br><br>    # Shuffle training data<br>    shuffle_indices = np.random.permutation(np.arange(len(y_train)))<br>    X_train = X_train[shuffle_indices]<br>    y_train = y_train[shuffle_indices]<br><br>    # Minibatch training<br>    for i in range(0, len(y_train) // batch_size):<br>        start = i * batch_size<br>        batch_x = X_train[start:start + batch_size]<br>        batch_y = y_train[start:start + batch_size]<br>        # Run optimizer with batch<br>        net.run(opt, feed_dict={X: batch_x, Y: batch_y})<br><br>        # Show progress<br>        if np.mod(i, 5) == 0:<br>            # Prediction<br>            pred = net.run(out, feed_dict={X: X_test})<br>            line2.set_ydata(pred)<br>            plt.title(&#39;Epoch &#39; + str(e) + &#39;, Batch &#39; + str(i))<br>            file_name = &#39;img/epoch_&#39; + str(e) + &#39;_batch_&#39; + str(i) + &#39;.jpg&#39;<br>            plt.savefig(file_name)<br>            plt.pause(0.01)</pre><pre name="488f" id="488f" class="graf graf--pre graf-after--pre"># Print final MSE after Training<br>mse_final = net.run(mse, feed_dict={X: X_test, Y: y_test})<br>print(mse_final)</pre><p name="fe39" id="fe39" class="graf graf--p graf-after--pre">During the training, we evaluate the networks predictions on the test set — the data which is not learned, but set aside — for every 5th batch and visualize it. Additionally, the images are exported to disk and later combined into a video animation of the training process (see below). The model quickly learns the shape and location of the time series in the test data and is able to produce an accurate prediction after some epochs. Nice!</p><figure name="2546" id="2546" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75%;"></div><div class="progressiveMedia js-progressiveMedia"><img src="https://i.embed.ly/1/display/resize?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FI_KMlGavtiQ%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;width=40" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><div class="iframeContainer"><IFRAME data-width="640" data-height="480" width="640" height="480" data-src="/media/3ed7ecd168f27d9dc8c59616d2543bdd?postId=30505541d877" data-media-id="3ed7ecd168f27d9dc8c59616d2543bdd" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FI_KMlGavtiQ%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07" class="progressiveMedia-iframe js-progressiveMedia-iframe" allowfullscreen frameborder="0"></IFRAME></div><noscript class="js-progressiveMedia-inner"><div class="iframeContainer"><IFRAME data-width="640" data-height="480" width="640" height="480" src="/media/3ed7ecd168f27d9dc8c59616d2543bdd?postId=30505541d877" data-media-id="3ed7ecd168f27d9dc8c59616d2543bdd" data-thumbnail="https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FI_KMlGavtiQ%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07" allowfullscreen frameborder="0"></IFRAME></div></noscript></div></div><figcaption class="imageCaption">Video animation of the network’s test data prediction (orange) during training.</figcaption></figure><p name="fca4" id="fca4" class="graf graf--p graf-after--figure">One can see that the networks rapidly adapts to the basic shape of the time series and continues to learn finer patterns of the data. This also corresponds to the Adam learning scheme that lowers the learning rate during model training in order not to overshoot the optimization minimum. After 10 epochs, we have a pretty close fit to the test data! The final test MSE equals 0.00078 (it is very low, because the target is scaled). The mean absolute percentage error of the forecast on the test set is equal to 5.31% which is pretty good. Note, that this is just a fit to the test data, no actual out of sample metrics in a real world scenario.</p><figure name="2688" id="2688" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 601px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 85.9%;"></div><div class="progressiveMedia js-progressiveMedia graf-image" data-image-id="1*tnbyLo91bfJUexf7TnJamA.png" data-width="724" data-height="622" data-action="zoom" data-action-value="1*tnbyLo91bfJUexf7TnJamA.png"><img src="https://cdn-images-1.medium.com/freeze/max/60/1*tnbyLo91bfJUexf7TnJamA.png?q=20" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*tnbyLo91bfJUexf7TnJamA.png"><noscript class="js-progressiveMedia-inner"><img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*tnbyLo91bfJUexf7TnJamA.png"></noscript></div></div><figcaption class="imageCaption">Scatter plot between predicted and actual S&amp;P prices (scaled).</figcaption></figure><p name="11b6" id="11b6" class="graf graf--p graf-after--figure">Please note that there are tons of ways of further improving this result: design of layers and neurons, choosing different initialization and activation schemes, introduction of dropout layers of neurons, early stopping and so on. Furthermore, different types of deep learning models, such as recurrent neural networks might achieve better performance on this task. However, this is not the scope of this introductory post.</p><h4 name="6a5a" id="6a5a" class="graf graf--h4 graf-after--p">Conclusion and outlook</h4><p name="cc16" id="cc16" class="graf graf--p graf-after--h4">The release of TensorFlow was a landmark event in deep learning research. Its flexibility and performance allows researchers to develop all kinds of sophisticated neural network architectures as well as other ML algorithms. However, flexibility comes at the cost of longer time-to-model cycles compared to higher level APIs such as <a href="https://keras.io/" data-href="https://keras.io/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Keras</a> or <a href="https://mxnet.incubator.apache.org/" data-href="https://mxnet.incubator.apache.org/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">MxNet</a>. Nonetheless, I am sure that TensorFlow will make its way to the de-facto standard in neural network and deep learning development in research and practical applications. Many of our customers are already using TensorFlow or start developing projects that employ TensorFlow models. Also our <a href="https://www.statworx.com/de/data-science/" data-href="https://www.statworx.com/de/data-science/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">data science consultants</a> at STATWORX are heavily using TensorFlow for deep learning and neural net research and development. Let’s see what Google has planned for the future of TensorFlow. One thing that is missing, at least in my opinion, is a neat graphical user interface for designing and developing neural net architectures with TensorFlow backend. Maybe, this is something Google is already working on ;)</p><p name="2e63" id="2e63" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Update:</strong> I’ve added both the Python script as well as a (zipped) dataset to a <a href="https://github.com/sebastianheinz/stockprediction" data-href="https://github.com/sebastianheinz/stockprediction" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">Github repository</a>. Feel free to clone and fork.</p><h3 name="5db2" id="5db2" class="graf graf--h3 graf-after--p">Final remarks</h3><p name="8a22" id="8a22" class="graf graf--p graf-after--h3">If you have any comments or questions on my story, feel free to comment below! I will try to answer them. Also, feel free to use my code or share this story with your peers on social platforms of your choice. Follow me on <a href="https://www.linkedin.com/in/sebastian-heinz-90885272/" data-href="https://www.linkedin.com/in/sebastian-heinz-90885272/" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">LinkedIn</a> or <a href="https://twitter.com/statworx" data-href="https://twitter.com/statworx" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">Twitter</a>, if you want to stay in touch.</p><p name="7985" id="7985" class="graf graf--p graf-after--p">Make sure, you also check the awesome <a href="https://www.statworx.com/de/blog" data-href="https://www.statworx.com/de/blog" class="markup--anchor markup--p-anchor" rel="noopener nofollow" target="_blank">STATWORX Blog</a> for more interesting data science, ML and AI content straight from the our office in Frankfurt, Germany!</p><p name="840a" id="840a" class="graf graf--p graf-after--p">If you’re interested in more quality content like this, join my mailing list, constantly bringing you new data science, machine learning and AI reads and treats from me and my team right into your inbox!</p><figure name="efec" id="efec" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 50%;"></div><div class="iframeContainer"><IFRAME data-width="800" data-height="400" width="700" height="350" src="/media/e406f5720750ce3590e4050d11d8501a?postId=30505541d877" data-media-id="e406f5720750ce3590e4050d11d8501a" allowfullscreen frameborder="0"></IFRAME></div></div></figure><p name="22e4" id="22e4" class="graf graf--p graf-after--figure graf--trailing">I hope you liked my story, I really enjoyed writing it. Thank you for your time!</p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link"   href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/deep-learning?source=post" data-action-source="post">Deep Learning</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/tensorflow?source=post" data-action-source="post">TensorFlow</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/stock-market?source=post" data-action-source="post">Stock Market</a></li><li><a class="link u-baseColor--link"   href="https://medium.com/tag/tutorial?source=post" data-action-source="post">Tutorial</a></li></ul></div></div></div><div class="postActions js-postActionsFooter "><div class="u-flexCenter"><div class="u-flex1"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="30505541d877" data-is-icon-29px="true" data-is-circle="true" data-has-recommend-list="true" data-source="post_actions_footer-----30505541d877---------------------clap_footer" data-clap-string-singular="clap" data-clap-string-plural="claps"><div class="u-relative u-foreground"><button class="button button--large button--circle button--withChrome u-baseColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker clapButton--largePill u-relative u-foreground u-xs-paddingLeft13 u-width60 u-height60 u-accentColor--textNormal u-accentColor--buttonNormal clap-onboardingcollection"  data-action="multivote" data-action-value="30505541d877" data-action-type="long-press" data-action-source="post_actions_footer-----30505541d877---------------------clap_footer" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" ><path d="M28.86 17.342l-3.64-6.402c-.292-.433-.712-.729-1.163-.8a1.124 1.124 0 0 0-.889.213c-.63.488-.742 1.181-.33 2.061l1.222 2.587 1.4 2.46c2.234 4.085 1.511 8.007-2.145 11.663-.26.26-.526.49-.797.707 1.42-.084 2.881-.683 4.292-2.094 3.822-3.823 3.565-7.876 2.05-10.395zm-6.252 11.075c3.352-3.35 3.998-6.775 1.978-10.469l-3.378-5.945c-.292-.432-.712-.728-1.163-.8a1.122 1.122 0 0 0-.89.213c-.63.49-.742 1.182-.33 2.061l1.72 3.638a.502.502 0 0 1-.806.568l-8.91-8.91a1.335 1.335 0 0 0-1.887 1.886l5.292 5.292a.5.5 0 0 1-.707.707l-5.292-5.292-1.492-1.492c-.503-.503-1.382-.505-1.887 0a1.337 1.337 0 0 0 0 1.886l1.493 1.492 5.292 5.292a.499.499 0 0 1-.353.854.5.5 0 0 1-.354-.147L5.642 13.96a1.338 1.338 0 0 0-1.887 0 1.338 1.338 0 0 0 0 1.887l2.23 2.228 3.322 3.324a.499.499 0 0 1-.353.853.502.502 0 0 1-.354-.146l-3.323-3.324a1.333 1.333 0 0 0-1.886 0 1.325 1.325 0 0 0-.39.943c0 .356.138.691.39.943l6.396 6.397c3.528 3.53 8.86 5.313 12.821 1.353zM12.73 9.26l5.68 5.68-.49-1.037c-.518-1.107-.426-2.13.224-2.89l-3.303-3.304a1.337 1.337 0 0 0-1.886 0 1.326 1.326 0 0 0-.39.944c0 .217.067.42.165.607zm14.787 19.184c-1.599 1.6-3.417 2.392-5.353 2.392-.349 0-.7-.03-1.058-.082a7.922 7.922 0 0 1-3.667.887c-3.049 0-6.115-1.626-8.359-3.87l-6.396-6.397A2.315 2.315 0 0 1 2 19.724a2.327 2.327 0 0 1 1.923-2.296l-.875-.875a2.339 2.339 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.647l-.139-.139c-.91-.91-.91-2.39 0-3.3.884-.884 2.421-.882 3.301 0l.138.14a2.335 2.335 0 0 1 3.948-1.24l.093.092c.091-.423.291-.828.62-1.157a2.336 2.336 0 0 1 3.3 0l3.384 3.386a2.167 2.167 0 0 1 1.271-.173c.534.086 1.03.354 1.441.765.11-.549.415-1.034.911-1.418a2.12 2.12 0 0 1 1.661-.41c.727.117 1.385.565 1.853 1.262l3.652 6.423c1.704 2.832 2.025 7.377-2.205 11.607zM13.217.484l-1.917.882 2.37 2.837-.454-3.719zm8.487.877l-1.928-.86-.44 3.697 2.368-2.837zM16.5 3.293L15.478-.005h2.044L16.5 3.293z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--33px u-relative u-topNegative2 u-xs-top0"><svg class="svgIcon-use" width="33" height="33" ><g fill-rule="evenodd"><path d="M29.58 17.1l-3.854-6.78c-.365-.543-.876-.899-1.431-.989a1.491 1.491 0 0 0-1.16.281c-.42.327-.65.736-.7 1.207v.001l3.623 6.367c2.46 4.498 1.67 8.802-2.333 12.807-.265.265-.536.505-.81.728 1.973-.222 3.474-1.286 4.45-2.263 4.166-4.165 3.875-8.6 2.215-11.36zm-4.831.82l-3.581-6.3c-.296-.439-.725-.742-1.183-.815a1.105 1.105 0 0 0-.89.213c-.647.502-.755 1.188-.33 2.098l1.825 3.858a.601.601 0 0 1-.197.747.596.596 0 0 1-.77-.067L10.178 8.21c-.508-.506-1.393-.506-1.901 0a1.335 1.335 0 0 0-.393.95c0 .36.139.698.393.95v.001l5.61 5.61a.599.599 0 1 1-.848.847l-5.606-5.606c-.001 0-.002 0-.003-.002L5.848 9.375a1.349 1.349 0 0 0-1.902 0 1.348 1.348 0 0 0 0 1.901l1.582 1.582 5.61 5.61a.6.6 0 0 1-.848.848l-5.61-5.61c-.51-.508-1.393-.508-1.9 0a1.332 1.332 0 0 0-.394.95c0 .36.139.697.393.952l2.363 2.362c.002.001.002.002.002.003l3.52 3.52a.6.6 0 0 1-.848.847l-3.522-3.523h-.001a1.336 1.336 0 0 0-.95-.393 1.345 1.345 0 0 0-.949 2.295l6.779 6.78c3.715 3.713 9.327 5.598 13.49 1.434 3.527-3.528 4.21-7.13 2.086-11.015zM11.817 7.727c.06-.328.213-.64.466-.893.64-.64 1.755-.64 2.396 0l3.232 3.232c-.82.783-1.09 1.833-.764 2.992l-5.33-5.33z"/><path d="M13.285.48l-1.916.881 2.37 2.837z"/><path d="M21.719 1.361L19.79.501l-.44 3.697z"/><path d="M16.502 3.298L15.481 0h2.043z"/></g></svg></span></span></button><div class="clapUndo u-width60 u-round u-height32 u-absolute u-borderBox u-paddingRight5 u-transition--transform200Springu-backgroundGrayLighter js-clapUndo" style="top: 14px; padding: 2px;"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon u-floatRight"  data-action="multivote-undo" data-action-value="30505541d877"><span class="svgIcon svgIcon--removeThin svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M20.13 8.11l-5.61 5.61-5.609-5.61-.801.801 5.61 5.61-5.61 5.61.801.8 5.61-5.609 5.61 5.61.8-.801-5.609-5.61 5.61-5.61" fill-rule="evenodd"/></svg></span></button></div></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft16"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton u-textColorDarker"  data-action="show-recommends" data-action-value="30505541d877">7.2K claps</button><span class="u-xs-hide"></span></span></div></div><div class="buttonSet u-flex0"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12"   href="https://medium.com/p/30505541d877/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"/></svg></span></span></a><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless u-xs-hide u-marginRight12"   href="https://medium.com/p/30505541d877/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"/></svg></span></span></a><button class="button button--large button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon u-xs-show u-marginRight10"  title="Share this story on Twitter or Facebook" aria-label="Share this story on Twitter or Facebook" data-action="show-share-popover" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--share svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M20.385 8H19a.5.5 0 1 0 .011 1h1.39c.43 0 .84.168 1.14.473.31.305.48.71.48 1.142v10.77c0 .43-.17.837-.47 1.142-.3.305-.71.473-1.14.473H8.62c-.43 0-.84-.168-1.144-.473a1.603 1.603 0 0 1-.473-1.142v-10.77c0-.43.17-.837.48-1.142A1.599 1.599 0 0 1 8.62 9H10a.502.502 0 0 0 0-1H8.615c-.67 0-1.338.255-1.85.766-.51.51-.765 1.18-.765 1.85v10.77c0 .668.255 1.337.766 1.848.51.51 1.18.766 1.85.766h11.77c.668 0 1.337-.255 1.848-.766.51-.51.766-1.18.766-1.85v-10.77c0-.668-.255-1.337-.766-1.848A2.61 2.61 0 0 0 20.384 8zm-8.67-2.508L14 3.207v8.362c0 .27.224.5.5.5s.5-.23.5-.5V3.2l2.285 2.285a.49.49 0 0 0 .704-.001.511.511 0 0 0 0-.708l-3.14-3.14a.504.504 0 0 0-.71 0L11 4.776a.501.501 0 0 0 .71.706" fill-rule="evenodd"/></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon"  data-action="respond" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"/></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-marginRight12"  data-action="scroll-to-responses">78</button><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton"  title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="30505541d877" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px u-marginRight4"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"/></svg></span></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon js-moreActionsButton"  title="More actions" aria-label="More actions" data-action="more-actions"><span class="svgIcon svgIcon--more svgIcon--25px"><svg class="svgIcon-use" width="25" height="25"  viewBox="-480.5 272.5 21 21"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"/></svg></span></button></div></div></div></div><div class="u-maxWidth740 u-paddingTop20 u-marginTop20 u-borderTopLightest container u-paddingBottom20 u-xs-paddingBottom10 js-postAttributionFooterContainer"><div class="row js-postFooterInfo"><div class="col u-size6of12 u-xs-size12of12"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState" data-user-id="1165a0d0d97e"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton"  data-action="toggle-block-user" data-action-value="1165a0d0d97e" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton"  data-action="toggle-subscribe-user" data-action-value="1165a0d0d97e" data-action-source="footer_card-1165a0d0d97e-------------------------follow_footer" data-subscribe-source="footer_card" data-follow-context-entity-id="30505541d877"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell"><a class="link u-baseColor--link avatar"   href="https://medium.com/@STATWORX?source=footer_card" title="Go to the profile of Sebastian Heinz" aria-label="Go to the profile of Sebastian Heinz" data-action-source="footer_card" data-user-id="1165a0d0d97e" dir="auto"><img  src="https://cdn-images-1.medium.com/fit/c/120/120/1*8lHWKHMXnJJDjMmFaLSFTA.jpeg" class="avatar-image avatar-image--small" alt="Go to the profile of Sebastian Heinz"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal"   href="https://medium.com/@STATWORX" property="cc:attributionName" title="Go to the profile of Sebastian Heinz" aria-label="Go to the profile of Sebastian Heinz" rel="author cc:attributionUrl" data-user-id="1165a0d0d97e" dir="auto">Sebastian Heinz</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">CEO @ STATWORX. Doing data science, stats and ML for over a decade. Food, wine and cocktail enthusiast. Check our website: <a rel="nofollow" href="https://www.statworx.com">https://www.statworx.com</a></p></div></li></div><div class="col u-size6of12 u-xs-size12of12 u-xs-marginTop30"><li class="uiScale uiScale-ui--small uiScale-caption--regular u-block u-paddingBottom18 js-cardCollection"><div class="u-marginLeft20 u-floatRight"><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton"  data-action="toggle-follow-collection" data-action-source="footer_card----33272dbbd858----------------------follow_footer" data-collection-id="33272dbbd858"><span class="button-label  js-buttonLabel">Follow</span></button></div><div class="u-tableCell "><a class="link u-baseColor--link avatar avatar--roundedRectangle"   href="https://medium.com/mlreview?source=footer_card" title="Go to ML Review" aria-label="Go to ML Review" data-action-source="footer_card"><img src="https://cdn-images-1.medium.com/fit/c/120/120/1*3yjjoZ--eh8E84rH1xRIhQ.jpeg" class="avatar-image u-size60x60" alt="ML Review"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="ui-h3 u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal"   href="https://medium.com/mlreview?source=footer_card" rel="collection" data-action-source="footer_card">ML Review</a></h3><p class="ui-body u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">Highlights from Machine Learning Research, Projects and Learning Materials. From and For ML Scientists, Engineers an Enthusiasts.</p><div class="buttonSet"></div></div></li></div></div></div><div class="js-postFooterPlacements" data-post-id="30505541d877" data-collection-id="33272dbbd858"></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><aside class="u-marginAuto u-maxWidth1032 js-postLeftSidebar"><div class="u-foreground u-top0 u-transition--fadeOut300 u-fixed u-sm-hide js-postShareWidget"><div class="u-breakWord u-md-hide u-width131"><div class="u-width131 collection-title u-fontWeightBold u-fontSize18 u-lineHeightTight"><a href="https://medium.com/mlreview?source=logo-c76ae1d30db3">ML Review</a></div><div class="u-width131 u-multiline-clamp u-textColorNormal u-fontSize14 u-lineHeightTight u-paddingTop3">Highlights from Machine Learning Research, Projects and Learning Materials. From and For ML…</div><div class="u-paddingTop15 u-paddingBottom30 u-borderBottomLight u-marginBottom30"><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal js-relationshipButton"  data-action="toggle-follow-collection" data-action-source="post_sidebar----33272dbbd858----------------------post_sidebar" data-collection-id="33272dbbd858"><span class="button-label  js-buttonLabel">Follow</span></button></div></div><ul><li class="u-marginVertical10"><div class="multirecommend js-actionMultirecommend u-flexCenter" data-post-id="30505541d877" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_share_widget-----30505541d877---------------------clap_sidebar"><div class="u-relative u-foreground"><button class="button button--primary button--large button--chromeless u-accentColor--buttonNormal button--withIcon button--withSvgIcon clapButton js-actionMultirecommendButton clapButton--darker"  data-action="multivote" data-action-value="30505541d877" data-action-type="long-press" data-action-source="post_share_widget-----30505541d877---------------------clap_sidebar" aria-label="Clap"><span class="button-defaultState"><span class="svgIcon svgIcon--clap svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><g fill-rule="evenodd"><path d="M13.739 1l.761 2.966L15.261 1z"/><path d="M16.815 4.776l1.84-2.551-1.43-.471z"/><path d="M10.378 2.224l1.84 2.551-.408-3.022z"/><path d="M22.382 22.622c-1.04 1.04-2.115 1.507-3.166 1.608.168-.14.332-.29.492-.45 2.885-2.886 3.456-5.982 1.69-9.211l-1.101-1.937-.955-2.02c-.315-.676-.235-1.185.245-1.556a.836.836 0 0 1 .66-.16c.342.056.66.28.879.605l2.856 5.023c1.179 1.962 1.379 5.119-1.6 8.098m-13.29-.528l-5.02-5.02a1 1 0 0 1 .707-1.701c.255 0 .512.098.707.292l2.607 2.607a.442.442 0 0 0 .624-.624L6.11 15.04l-1.75-1.75a.998.998 0 1 1 1.41-1.413l4.154 4.156a.44.44 0 0 0 .624 0 .44.44 0 0 0 0-.624l-4.152-4.153-1.172-1.171a.998.998 0 0 1 0-1.41 1.018 1.018 0 0 1 1.41 0l1.172 1.17 4.153 4.152a.437.437 0 0 0 .624 0 .442.442 0 0 0 0-.624L8.43 9.222a.988.988 0 0 1-.291-.705.99.99 0 0 1 .29-.706 1 1 0 0 1 1.412 0l6.992 6.993a.443.443 0 0 0 .71-.501l-1.35-2.856c-.315-.676-.235-1.185.246-1.557a.85.85 0 0 1 .66-.16c.342.056.659.28.879.606L20.628 15c1.573 2.876 1.067 5.545-1.544 8.156-1.396 1.397-3.144 1.966-5.063 1.652-1.713-.286-3.463-1.248-4.928-2.714zM12.99 6.976l2.562 2.562c-.497.607-.563 1.414-.155 2.284l.265.562-4.257-4.257a.98.98 0 0 1-.117-.445c0-.267.104-.517.292-.706a1.023 1.023 0 0 1 1.41 0zm8.887 2.06c-.375-.557-.902-.916-1.486-1.011a1.738 1.738 0 0 0-1.342.332c-.376.29-.61.656-.712 1.065a2.1 2.1 0 0 0-1.095-.562 1.776 1.776 0 0 0-.992.128l-2.636-2.636a1.883 1.883 0 0 0-2.658 0 1.862 1.862 0 0 0-.478.847 1.886 1.886 0 0 0-2.671-.012 1.867 1.867 0 0 0-.503.909c-.754-.754-1.992-.754-2.703-.044a1.881 1.881 0 0 0 0 2.658c-.288.12-.605.288-.864.547a1.884 1.884 0 0 0 0 2.659l.624.622a1.879 1.879 0 0 0-.91 3.16l5.019 5.02c1.595 1.594 3.515 2.645 5.408 2.959a7.16 7.16 0 0 0 1.173.098c1.026 0 1.997-.24 2.892-.7.279.04.555.065.828.065 1.53 0 2.969-.628 4.236-1.894 3.338-3.338 3.083-6.928 1.738-9.166l-2.868-5.043z"/></g></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--clapFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><g fill-rule="evenodd"><path d="M13.738 1l.762 2.966L15.262 1z"/><path d="M18.634 2.224l-1.432-.47-.408 3.022z"/><path d="M11.79 1.754l-1.431.47 1.84 2.552z"/><path d="M24.472 14.307l-3.023-5.32c-.287-.426-.689-.705-1.123-.776a1.16 1.16 0 0 0-.911.221c-.297.231-.474.515-.535.84.017.022.036.04.053.063l2.843 5.001c1.95 3.564 1.328 6.973-1.843 10.144a8.46 8.46 0 0 1-.549.501c1.205-.156 2.328-.737 3.351-1.76 3.268-3.268 3.041-6.749 1.737-8.914"/><path d="M14.58 10.887c-.156-.83.096-1.569.692-2.142L12.78 6.252c-.5-.504-1.378-.504-1.879 0-.178.18-.273.4-.329.63l4.008 4.005z"/><path d="M17.812 10.04c-.218-.323-.539-.55-.88-.606a.814.814 0 0 0-.644.153c-.176.137-.713.553-.24 1.566l1.43 3.025a.539.539 0 1 1-.868.612L9.2 7.378a.986.986 0 1 0-1.395 1.395l4.401 4.403a.538.538 0 1 1-.762.762L7.046 9.54 5.802 8.295a.99.99 0 0 0-1.396 0 .981.981 0 0 0 0 1.394l1.241 1.241 4.402 4.403a.537.537 0 0 1 0 .761.535.535 0 0 1-.762 0L4.89 11.696a.992.992 0 0 0-1.399-.003.983.983 0 0 0 0 1.395l1.855 1.854 2.763 2.765a.538.538 0 0 1-.76.761l-2.765-2.764a.982.982 0 0 0-1.395 0 .989.989 0 0 0 0 1.395l5.32 5.32c3.371 3.372 6.64 4.977 10.49 1.126C21.74 20.8 22.271 18 20.62 14.982l-2.809-4.942z"/></g></svg></span></span></button></div><span class="u-relative u-background js-actionMultirecommendCount u-marginLeft5"><button class="button button--chromeless u-baseColor--buttonNormal js-multirecommendCountButton"  data-action="show-recommends" data-action-value="30505541d877">7.2K</button></span></div></li><li class="u-marginVertical10 u-marginLeft3"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton"  title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="add-to-bookmarks" data-action-value="30505541d877" data-action-source="post_share_widget-----30505541d877---------------------bookmark_sidebar"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"/></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"/></svg></span></span></button></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless"   href="https://medium.com/p/30505541d877/share/twitter" title="Share on Twitter" aria-label="Share on Twitter" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--twitterFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M22.053 7.54a4.474 4.474 0 0 0-3.31-1.455 4.526 4.526 0 0 0-4.526 4.524c0 .35.04.7.082 1.05a12.9 12.9 0 0 1-9.3-4.77c-.39.69-.61 1.46-.65 2.26.03 1.6.83 2.99 2.02 3.79-.72-.02-1.41-.22-2.02-.57-.01.02-.01.04 0 .08-.01 2.17 1.55 4 3.63 4.44-.39.08-.79.13-1.21.16-.28-.03-.57-.05-.81-.08.54 1.77 2.21 3.08 4.2 3.15a9.564 9.564 0 0 1-5.66 1.94c-.34-.03-.7-.06-1.05-.08 2 1.27 4.38 2.02 6.94 2.02 8.31 0 12.86-6.9 12.84-12.85.02-.24.01-.43 0-.65.89-.62 1.65-1.42 2.26-2.34-.82.38-1.69.62-2.59.72a4.37 4.37 0 0 0 1.94-2.51c-.84.53-1.81.9-2.83 1.13z"/></svg></span></span></a></li><li class="u-marginVertical10 u-marginLeft3"><a class="button button--dark button--chromeless u-baseColor--buttonDark button--withIcon button--withSvgIcon button--dark button--chromeless"   href="https://medium.com/p/30505541d877/share/facebook" title="Share on Facebook" aria-label="Share on Facebook" target="_blank" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--facebookSquare svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" ><path d="M23.209 5H5.792A.792.792 0 0 0 5 5.791V23.21c0 .437.354.791.792.791h9.303v-7.125H12.72v-2.968h2.375v-2.375c0-2.455 1.553-3.662 3.741-3.662 1.049 0 1.95.078 2.213.112v2.565h-1.517c-1.192 0-1.469.567-1.469 1.397v1.963h2.969l-.594 2.968h-2.375L18.11 24h5.099a.791.791 0 0 0 .791-.791V5.79a.791.791 0 0 0-.791-.79"/></svg></span></span></a></li></ul></div></aside><style class="js-collectionStyle">
.u-accentColor--borderLight {border-color: #4487EE !important;}
.u-accentColor--borderNormal {border-color: #4487EE !important;}
.u-accentColor--borderDark {border-color: #4074C5 !important;}
.u-accentColor--iconLight .svgIcon,.u-accentColor--iconLight.svgIcon {fill: #4487EE !important;}
.u-accentColor--iconNormal .svgIcon,.u-accentColor--iconNormal.svgIcon {fill: #4487EE !important;}
.u-accentColor--iconDark .svgIcon,.u-accentColor--iconDark.svgIcon {fill: #4074C5 !important;}
.u-accentColor--textNormal {color: #4074C5 !important;}
.u-accentColor--hoverTextNormal:hover {color: #4074C5 !important;}
.u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #3D6BB1 !important;}
.u-accentColor--textDark {color: #3D6BB1 !important;}
.u-accentColor--backgroundLight {background-color: #4487EE !important;}
.u-accentColor--backgroundNormal {background-color: #4487EE !important;}
.u-accentColor--backgroundDark {background-color: #4074C5 !important;}
.u-accentColor--buttonDark {border-color: #4074C5 !important; color: #3D6BB1 !important;}
.u-accentColor--buttonDark:hover {border-color: #3D6BB1 !important;}
.u-accentColor--buttonDark .icon:before,.u-accentColor--buttonDark .svgIcon{color: #4074C5 !important; fill: #4074C5 !important;}
.u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #4487EE !important; color: #4074C5 !important;}
.u-accentColor--buttonNormal:hover {border-color: #4074C5 !important;}
.u-accentColor--buttonNormal .icon:before,.u-accentColor--buttonNormal .svgIcon{color: #4487EE !important; fill: #4487EE !important;}
.u-accentColor--buttonNormal.button--filled .icon:before,.u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonDark.button--filled,.u-accentColor--buttonDark.button--withChrome.is-active,.u-accentColor--fillWhenActive.is-active {background-color: #4074C5 !important; border-color: #4074C5 !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #4487EE !important; border-color: #4487EE !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--user,.postArticle.is-withAccentColors .markup--query {color: #4074C5 !important;}.u-tintBgColor {background-color: rgba(45, 114, 217, 1) !important;}.u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(45, 114, 217, 1) 0%, rgba(45, 114, 217, 0) 100%) !important;}.u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(45, 114, 217, 0) 0%, rgba(45, 114, 217, 1) 100%) !important;}
.u-tintSpectrum .u-baseColor--borderLight {border-color: #9CBFF9 !important;}
.u-tintSpectrum .u-baseColor--borderNormal {border-color: #C1DAFF !important;}
.u-tintSpectrum .u-baseColor--borderDark {border-color: #E4F4FF !important;}
.u-tintSpectrum .u-baseColor--iconLight .svgIcon,.u-tintSpectrum .u-baseColor--iconLight.svgIcon {fill: #9CBFF9 !important;}
.u-tintSpectrum .u-baseColor--iconNormal .svgIcon,.u-tintSpectrum .u-baseColor--iconNormal.svgIcon {fill: #C1DAFF !important;}
.u-tintSpectrum .u-baseColor--iconDark .svgIcon,.u-tintSpectrum .u-baseColor--iconDark.svgIcon {fill: #E4F4FF !important;}
.u-tintSpectrum .u-baseColor--textNormal {color: #C1DAFF !important;}
.u-tintSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--textDark {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--textDarker {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--backgroundLight {background-color: #9CBFF9 !important;}
.u-tintSpectrum .u-baseColor--backgroundNormal {background-color: #C1DAFF !important;}
.u-tintSpectrum .u-baseColor--backgroundDark {background-color: #E4F4FF !important;}
.u-tintSpectrum .u-baseColor--buttonLight {border-color: #9CBFF9 !important; color: #9CBFF9 !important;}
.u-tintSpectrum .u-baseColor--buttonLight:hover {border-color: #9CBFF9 !important;}
.u-tintSpectrum .u-baseColor--buttonLight .icon:before,.u-tintSpectrum .u-baseColor--buttonLight .svgIcon {color: #9CBFF9 !important; fill: #9CBFF9 !important;}
.u-tintSpectrum .u-baseColor--buttonDark {border-color: #E4F4FF !important; color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark:hover {border-color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark .icon:before,.u-tintSpectrum .u-baseColor--buttonDark .svgIcon {color: #E4F4FF !important; fill: #E4F4FF !important;}
.u-tintSpectrum .u-baseColor--buttonNormal {border-color: #C1DAFF !important; color: #C1DAFF !important;}
.u-tintSpectrum .u-baseColor--buttonNormal:hover {border-color: #E4F4FF !important;}
.u-tintSpectrum .u-baseColor--buttonNormal .icon:before,.u-tintSpectrum .u-baseColor--buttonNormal .svgIcon {color: #C1DAFF !important; fill: #C1DAFF !important;}
.u-tintSpectrum .u-baseColor--buttonDark.button--filled,.u-tintSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: #E4F4FF !important; border-color: #E4F4FF !important; color: rgba(45, 114, 217, 1) !important; fill: rgba(45, 114, 217, 1) !important;}
.u-tintSpectrum .u-baseColor--buttonNormal.button--filled,.u-tintSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: #C1DAFF !important; border-color: #C1DAFF !important; color: rgba(45, 114, 217, 1) !important; fill: rgba(45, 114, 217, 1) !important;}
.u-tintSpectrum .u-baseColor--link {color: #C1DAFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--darken:active {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--dark {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-tintSpectrum .u-baseColor--link.link--dark.link--darken:active {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--link.link--darker {color: #F6FFFF !important;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: #9CBFF9;}
.u-tintSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: #9CBFF9;}
.u-tintSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: #9CBFF9;}
.u-tintSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: #F6FFFF !important;}
.u-tintSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: #F6FFFF !important;}
.u-tintSpectrum  .ui-h1,.u-tintSpectrum  .ui-h2,.u-tintSpectrum  .ui-h3,.u-tintSpectrum  .ui-h4,.u-tintSpectrum  .ui-brand1,.u-tintSpectrum  .ui-brand2,.u-tintSpectrum  .ui-captionStrong {color: #F6FFFF !important; fill: #F6FFFF !important;}
.u-tintSpectrum  .ui-body,.u-tintSpectrum  .ui-caps {color: #F6FFFF !important; fill: #F6FFFF !important;}
.u-tintSpectrum  .ui-summary,.u-tintSpectrum  .ui-caption {color: #9CBFF9 !important; fill: #9CBFF9 !important;}
.u-tintSpectrum .u-accentColor--borderLight {border-color: #9CBFF9 !important;}
.u-tintSpectrum .u-accentColor--borderNormal {border-color: #C1DAFF !important;}
.u-tintSpectrum .u-accentColor--borderDark {border-color: #E4F4FF !important;}
.u-tintSpectrum .u-accentColor--iconLight .svgIcon,.u-tintSpectrum .u-accentColor--iconLight.svgIcon {fill: #9CBFF9 !important;}
.u-tintSpectrum .u-accentColor--iconNormal .svgIcon,.u-tintSpectrum .u-accentColor--iconNormal.svgIcon {fill: #C1DAFF !important;}
.u-tintSpectrum .u-accentColor--iconDark .svgIcon,.u-tintSpectrum .u-accentColor--iconDark.svgIcon {fill: #E4F4FF !important;}
.u-tintSpectrum .u-accentColor--textNormal {color: #C1DAFF !important;}
.u-tintSpectrum .u-accentColor--hoverTextNormal:hover {color: #C1DAFF !important;}
.u-tintSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: #F6FFFF !important;}
.u-tintSpectrum .u-accentColor--textDark {color: #F6FFFF !important;}
.u-tintSpectrum .u-accentColor--backgroundLight {background-color: #9CBFF9 !important;}
.u-tintSpectrum .u-accentColor--backgroundNormal {background-color: #C1DAFF !important;}
.u-tintSpectrum .u-accentColor--backgroundDark {background-color: #E4F4FF !important;}
.u-tintSpectrum .u-accentColor--buttonDark {border-color: #E4F4FF !important; color: #F6FFFF !important;}
.u-tintSpectrum .u-accentColor--buttonDark:hover {border-color: #F6FFFF !important;}
.u-tintSpectrum .u-accentColor--buttonDark .icon:before,.u-tintSpectrum .u-accentColor--buttonDark .svgIcon{color: #E4F4FF !important; fill: #E4F4FF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: #C1DAFF !important; color: #C1DAFF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal:hover {border-color: #E4F4FF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal .svgIcon{color: #C1DAFF !important; fill: #C1DAFF !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-tintSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(45, 114, 217, 1) !important; fill: rgba(45, 114, 217, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonDark.button--filled,.u-tintSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-tintSpectrum .u-accentColor--fillWhenActive.is-active {background-color: #E4F4FF !important; border-color: #E4F4FF !important; color: rgba(45, 114, 217, 1) !important; fill: rgba(45, 114, 217, 1) !important;}
.u-tintSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-tintSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: #C1DAFF !important; border-color: #C1DAFF !important; color: rgba(45, 114, 217, 1) !important; fill: rgba(45, 114, 217, 1) !important;}
.u-tintSpectrum .postArticle.is-withAccentColors .markup--user,.u-tintSpectrum .postArticle.is-withAccentColors .markup--query {color: #C1DAFF !important;}
.u-accentColor--highlightFaint {background-color: rgba(226, 243, 255, 1) !important;}
.u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(178, 228, 255, 1) !important;}
.postArticle.is-withAccentColors .markup--quote.is-other {background-color: rgba(226, 243, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(226, 243, 255, 1), rgba(226, 243, 255, 1));}
.postArticle.is-withAccentColors .markup--quote.is-me {background-color: rgba(201, 235, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(201, 235, 255, 1), rgba(201, 235, 255, 1));}
.postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: rgba(178, 228, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(178, 228, 255, 1), rgba(178, 228, 255, 1));}
.postArticle.is-withAccentColors .markup--quote.is-selected {background-color: rgba(178, 228, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(178, 228, 255, 1), rgba(178, 228, 255, 1));}
.postArticle.is-withAccentColors .markup--highlight {background-color: rgba(178, 228, 255, 1) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(178, 228, 255, 1), rgba(178, 228, 255, 1));}.u-baseColor--iconNormal.avatar-halo {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}</style><style class="js-collectionStyleConstant">.u-imageBgColor {background-color: rgba(0, 0, 0, 0.24705882352941178);}
.u-imageSpectrum .u-baseColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconLight .svgIcon,.u-imageSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--iconNormal .svgIcon,.u-imageSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--iconDark .svgIcon,.u-imageSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--textDarker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-baseColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important; color: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-baseColor--buttonLight .icon:before,.u-imageSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-baseColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonDark .icon:before,.u-imageSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal .icon:before,.u-imageSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--buttonDark.button--filled,.u-imageSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--buttonNormal.button--filled,.u-imageSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-baseColor--link {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-imageSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--link.link--darker {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(255, 255, 255, 0.8);}
.u-imageSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-h1,.u-imageSpectrum  .ui-h2,.u-imageSpectrum  .ui-h3,.u-imageSpectrum  .ui-h4,.u-imageSpectrum  .ui-brand1,.u-imageSpectrum  .ui-brand2,.u-imageSpectrum  .ui-captionStrong {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-body,.u-imageSpectrum  .ui-caps {color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum  .ui-summary,.u-imageSpectrum  .ui-caption {color: rgba(255, 255, 255, 0.8) !important; fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--borderLight {border-color: rgba(255, 255, 255, 0.6980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderNormal {border-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--borderDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconLight .svgIcon,.u-imageSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(255, 255, 255, 0.8) !important;}
.u-imageSpectrum .u-accentColor--iconNormal .svgIcon,.u-imageSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--iconDark .svgIcon,.u-imageSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textNormal {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--textDark {color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--backgroundLight {background-color: rgba(255, 255, 255, 0.8980392156862745) !important;}
.u-imageSpectrum .u-accentColor--backgroundNormal {background-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--backgroundDark {background-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark {border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonDark .icon:before,.u-imageSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(255, 255, 255, 0.8980392156862745) !important; color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(255, 255, 255, 0.9490196078431372) !important; fill: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-imageSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonDark.button--filled,.u-imageSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-imageSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(255, 255, 255, 1) !important; border-color: rgba(255, 255, 255, 1) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-imageSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(255, 255, 255, 0.9490196078431372) !important; border-color: rgba(255, 255, 255, 0.9490196078431372) !important; color: rgba(0, 0, 0, 0.24705882352941178) !important; fill: rgba(0, 0, 0, 0.24705882352941178) !important;}
.u-imageSpectrum .postArticle.is-withAccentColors .markup--user,.u-imageSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(255, 255, 255, 0.9490196078431372) !important;}
.u-imageSpectrum .u-accentColor--highlightFaint {background-color: rgba(255, 255, 255, 0.2) !important;}
.u-imageSpectrum .u-accentColor--highlightStrong.is-active .svgIcon {fill: rgba(255, 255, 255, 0.6) !important;}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: rgba(255, 255, 255, 0.2) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-other {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.2));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: rgba(255, 255, 255, 0.4) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-me {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.4), rgba(255, 255, 255, 0.4));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-targeted {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--quote.is-selected {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}
.postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: rgba(255, 255, 255, 0.6) !important;}
body.is-withMagicUnderlines .postArticle.is-withAccentColors .u-imageSpectrum .markup--highlight {background-color: transparent !important; background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.6));}.u-resetSpectrum .u-tintBgColor {background-color: rgba(255, 255, 255, 1) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeLeft:before {background-image: linear-gradient(to right, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0) 100%) !important;}.u-resetSpectrum .u-tintBgColor .u-fadeRight:after {background-image: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 100%) !important;}
.u-resetSpectrum .u-baseColor--borderLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--borderDark {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--iconLight .svgIcon,.u-resetSpectrum .u-baseColor--iconLight.svgIcon {fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconNormal .svgIcon,.u-resetSpectrum .u-baseColor--iconNormal.svgIcon {fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--iconDark .svgIcon,.u-resetSpectrum .u-baseColor--iconDark.svgIcon {fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textNormal {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--textNormal.u-baseColor--textDarken:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--textDarker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--backgroundLight {background-color: rgba(0, 0, 0, 0.09803921568627451) !important;}
.u-resetSpectrum .u-baseColor--backgroundNormal {background-color: rgba(0, 0, 0, 0.2) !important;}
.u-resetSpectrum .u-baseColor--backgroundDark {background-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight {border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight:hover {border-color: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonLight .icon:before,.u-resetSpectrum .u-baseColor--buttonLight .svgIcon {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark {border-color: rgba(0, 0, 0, 0.6) !important; color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonDark:hover {border-color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--buttonDark .icon:before,.u-resetSpectrum .u-baseColor--buttonDark .svgIcon {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal {border-color: rgba(0, 0, 0, 0.4980392156862745) !important; color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal:hover {border-color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal .icon:before,.u-resetSpectrum .u-baseColor--buttonNormal .svgIcon {color: rgba(0, 0, 0, 0.4980392156862745) !important; fill: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--buttonDark.button--filled,.u-resetSpectrum .u-baseColor--buttonDark.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2980392156862745) !important; border-color: rgba(0, 0, 0, 0.2980392156862745) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--buttonNormal.button--filled,.u-resetSpectrum .u-baseColor--buttonNormal.button--withChrome.is-active {background-color: rgba(0, 0, 0, 0.2) !important; border-color: rgba(0, 0, 0, 0.2) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-baseColor--link {color: rgba(0, 0, 0, 0.4980392156862745) !important;}
.u-resetSpectrum .u-baseColor--link.link--darkenOnHover:hover {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--darken:active {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark {color: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:hover,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:focus,.u-resetSpectrum .u-baseColor--link.link--dark.link--darken:active {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--link.link--darker {color: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-webkit-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal ::-moz-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .u-baseColor--placeholderNormal :-ms-input-placeholder {color: rgba(0, 0, 0, 0.2980392156862745);}
.u-resetSpectrum .svgIcon--logoWordmark {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum .svgIcon--logoMonogram {stroke: none !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-h1,.u-resetSpectrum  .ui-h2,.u-resetSpectrum  .ui-h3,.u-resetSpectrum  .ui-h4,.u-resetSpectrum  .ui-brand1,.u-resetSpectrum  .ui-brand2,.u-resetSpectrum  .ui-captionStrong {color: rgba(0, 0, 0, 0.8) !important; fill: rgba(0, 0, 0, 0.8) !important;}
.u-resetSpectrum  .ui-body,.u-resetSpectrum  .ui-caps {color: rgba(0, 0, 0, 0.6) !important; fill: rgba(0, 0, 0, 0.6) !important;}
.u-resetSpectrum  .ui-summary,.u-resetSpectrum  .ui-caption {color: rgba(0, 0, 0, 0.2980392156862745) !important; fill: rgba(0, 0, 0, 0.2980392156862745) !important;}
.u-resetSpectrum .u-accentColor--borderLight {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderNormal {border-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--borderDark {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconLight .svgIcon,.u-resetSpectrum .u-accentColor--iconLight.svgIcon {fill: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--iconNormal .svgIcon,.u-resetSpectrum .u-accentColor--iconNormal.svgIcon {fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--iconDark .svgIcon,.u-resetSpectrum .u-accentColor--iconDark.svgIcon {fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--hoverTextNormal:hover {color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--textNormal.u-accentColor--textDarken:hover {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--textDark {color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundLight {background-color: rgba(2, 184, 117, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundNormal {background-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--backgroundDark {background-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark {border-color: rgba(0, 171, 107, 1) !important; color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark:hover {border-color: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark .icon:before,.u-resetSpectrum .u-accentColor--buttonDark .svgIcon{color: rgba(28, 153, 99, 1) !important; fill: rgba(28, 153, 99, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:not(.clapButton--largePill) {border-color: rgba(2, 184, 117, 1) !important; color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal:hover {border-color: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal .svgIcon{color: rgba(0, 171, 107, 1) !important; fill: rgba(0, 171, 107, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .icon:before,.u-resetSpectrum .u-accentColor--buttonNormal.button--filled .svgIcon{color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonDark.button--filled,.u-resetSpectrum .u-accentColor--buttonDark.button--withChrome.is-active,.u-resetSpectrum .u-accentColor--fillWhenActive.is-active {background-color: rgba(28, 153, 99, 1) !important; border-color: rgba(28, 153, 99, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .u-accentColor--buttonNormal.button--filled:not(.clapButton--largePill),.u-resetSpectrum .u-accentColor--buttonNormal.button--withChrome.is-active:not(.clapButton--largePill) {background-color: rgba(0, 171, 107, 1) !important; border-color: rgba(0, 171, 107, 1) !important; color: rgba(255, 255, 255, 1) !important; fill: rgba(255, 255, 255, 1) !important;}
.u-resetSpectrum .postArticle.is-withAccentColors .markup--user,.u-resetSpectrum .postArticle.is-withAccentColors .markup--query {color: rgba(0, 171, 107, 1) !important;}</style></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"37560-4dd4c62","currentUser":{"userId":"c76ae1d30db3","username":"milad.to","name":"Milad amir Toutounchian","email":"milad.to@gmail.com","imageId":"0*4SEFINyUW8jmBVrV.","createdAt":1496184673303,"isVerified":true,"subscriberEmail":"","onboardingStatus":3,"googleAccountId":"113906860032214387751","googleEmail":"milad.to@gmail.com","hasPastMemberships":false,"isEnrolledInHightower":false,"isEligibleForHightower":true,"hightowerLastLockedAt":0,"isWriterProgramEnrolled":true,"isWriterProgramInvited":true,"isWriterProgramOptedOut":false,"writerProgramVersion":4,"writerProgramEnrolledAt":1551509519772,"friendLinkOnboarding":0,"hasAdditionalUnlocks":false,"hasApiAccess":false,"isQuarantined":false,"writerProgramDistributionSettingOptedIn":false},"currentUserHasUnverifiedEmail":false,"isAuthenticated":true,"isCurrentUserVerified":true,"language":"en-us","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.3zcQTeDFlV3HhQwoX8g-gg.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.AHOyO-i_kQOPVtd1D3V-Ag.js","hightower":"https://cdn-static-1.medium.com/_/fp/gen-js/main-hightower.bundle.unySA-1xBOKtS7EYNPGUSw.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.4MkH9obDeQktpQXqwR8NzQ.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.uSIdxZUQ14HRMlktssa7EQ.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.A5--rZtpdvaRMBwFRU9JAg.js","payments":"https://cdn-static-1.medium.com/_/fp/gen-js/main-payments.bundle.ZmtO7krtCnsilczCpHy8Rg.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.BMyWqVXPJKeA2XORrrvWoQ.js","power-readers":"https://cdn-static-1.medium.com/_/fp/gen-js/main-power-readers.bundle.ixLunhRsNrqwZtbZj7HnIQ.js","pubs":"https://cdn-static-1.medium.com/_/fp/gen-js/main-pubs.bundle.MwM21c8le0O7wmd1Uc7Mzg.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.kNiFRcL6W-81yiCd8v8Elw.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1558049353545:c61a670520fc","useragent":{"browser":"safari","family":"safari","os":"mac","version":11.1,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsVideoSections":true,"emojiSupportLevel":5,"isSearchBot":false,"isSyndicationBot":false,"isNativeAndroid":false,"isNativeIos":false,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","signup_services":"twitter,facebook,google,email,google-fastidv,google-one-tap","google_sign_in_android":true,"reengagement_notification_duration":3,"browsable_stream_config_bucket":"curated-topics","enable_dedicated_series_tab_api_ios":true,"enable_post_import":true,"available_monthly_plan":"60e220181034","available_annual_plan":"2c754bcc2995","disable_ios_resume_reading_toast":true,"is_not_medium_subscriber":true,"glyph_font_set":"m2","enable_branding":true,"enable_branding_fonts":true,"max_premium_content_per_user_under_metering":3,"enable_automated_mission_control_triggers":true,"enable_lite_profile":true,"enable_marketing_emails":true,"enable_topic_lifecycle_email":true,"enable_parsely":true,"enable_branch_io":true,"enable_ios_post_stats":true,"enable_lite_topics":true,"enable_lite_stories":true,"redis_read_write_splitting":true,"enable_tipalti_onboarding":true,"enable_international_tax_withholding_documentation":true,"enable_annual_renewal_reminder_email":true,"enable_janky_spam_rules":"users,posts","enable_new_collaborative_filtering_data":true,"android_rating_prompt_stories_read_threshold":2,"stripe_v3":true,"enable_google_one_tap":true,"enable_email_sign_in_captcha":true,"enable_rito_with_viewer_query":true,"enable_rito_with_flag_query":true,"enable_rito_post_handler":true,"enable_rito_sequence_post_recirc_query":true,"enable_rito_post_recirc_query":true,"enable_rito_topic_handler":true,"enable_rito_stats_post_handler":true,"enable_rito_stats_post_chart":true,"enable_rito_lifetime_earnings_tooltip":true,"enable_rito_stats_post_referrers_container":true,"enable_rito_post_feature_mutation":true,"enable_rito_post_unfeature_mutation":true,"enable_rito_quote_delete_mutation":true,"enable_rito_user_block_mutation":true,"enable_rito_user_unblock_mutation":true,"enable_rito_report_user_link":true,"enable_rito_bookmark_post_default":true,"enable_rito_unbookmark_post_default":true,"enable_rito_archive_post_default":true,"enable_rito_unarchive_post_default":true,"enable_rito_clap":true,"enable_rito_subscribe_series":true,"enable_rito_unsubscribe_series":true,"enable_rito_follow_topic":true,"enable_rito_unfollow_topic":true,"enable_rito_follow_user":true,"enable_rito_unfollow_user":true,"enable_rito_your_story_delete_mutation":true,"enable_rito_update_last_read_section":true,"enable_primary_topic_for_mobile":true,"enable_rito_sequence_post_handler":true,"enable_todays_highlights_ios":true,"enable_todays_highlights_android":true,"enable_logged_out_homepage_signup":true,"use_new_admin_topic_backend":true,"enable_quarantine_rules":true,"enable_lite_privacy_banner":true,"enable_patronus_on_kubernetes":true,"pub_sidebar":true,"disable_mobile_featured_chunk":true,"enable_rito_user_profile_overview_handler":true,"enable_rito_user_stream_overview":true,"enable_rito_user_profile_latest_handler":true,"enable_rito_user_stream_latest":true,"enable_rito_user_profile_actions":true,"enable_rito_post_actions":true,"enable_rito_user_profile_highlights_handler":true,"enable_rito_user_stream_highlights":true,"enable_rito_user_profile_series_handler":true,"enable_rito_user_stream_series":true,"enable_rito_user_profile_claps_handler":true,"enable_rito_user_stream_claps":true,"enable_rito_user_profile_responses_handler":true,"enable_rito_user_stream_responses":true,"enable_rito_billing_history_handler":true,"enable_rito_your_stories_handler":true,"enable_rito_sequence_library_handler":true,"enable_rito_series_handler":true,"enable_rito_amppost_handler":true,"enable_rito_follow_collection_mutation":true,"enable_rito_unfollow_collection_mutation":true,"enable_pub_newsletters":true,"enable_new_user_avatar_dropdown_menu":true,"enable_mobile_pubcrawl_home_feed":true,"enable_send_pub_digest":true,"enable_draft_in_post_cotent":true,"enable_paypal_cancel_webhook":true,"enable_retrained_ranking_model_digest":true,"enable_retrained_ranking_model_homepage":true},"xsrfToken":"GPfvspaXuOaN","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","fp":{"/icons/monogram-mask.svg":"https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico","faviconImageId":"1*8I-HPL0bfoIzGied-dzOvA.png","fontSets":[{"id":8,"url":"https://glyph.medium.com/css/e/sr/latin/e/ssr/latin/e/ssb/latin/m2.css"},{"id":11,"url":"https://glyph.medium.com/css/m2.css"},{"id":9,"url":"https://glyph.medium.com/css/mkt.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium-editor.3Y6xpZ-0FSdWDnPM3hSBIA.ico","glyphUrl":"https://glyph.medium.com"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"2b7e0c34030c5614\",\"ot-tracer-traceid\":\"0b82141051c8a11a\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","namespace":"medium-com","scope":{"default":["public_profile","email"],"connect":["public_profile","email"],"login":["public_profile","email"],"share":["public_profile","email"]}},"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","audioContentTopicId":"3792abbd134","brandedSequenceId":"7d337ddf1941","isDoNotAuth":false,"buggle":{"url":"https://buggle.medium.com","videoUrl":"https://cdn-videos-1.medium.com","audioUrl":"https://cdn-audio-1.medium.com"},"referrerType":2,"isMeteredOut":false,"meterConfig":{"maxUnlockCount":3,"windowLength":"MONTHLY"},"partnerProgramEmail":"partnerprogram@medium.com","userResearchPrompts":[{"promptId":"li_post_page","type":0,"url":"www.calendly.com"},{"promptId":"li_home_page","type":1,"url":"mediumuserfeedback.typeform.com/to/GcFjEO"},{"promptId":"li_profile_page","type":2,"url":"www.calendly.com"}],"recaptchaKey":"6LdAokEUAAAAAC7seICd4vtC8chDb3jIXDQulyUJ","signinWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"countryCode":"US","bypassMeter":false,"branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","paypal":{"clientMode":"production","oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com/redeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"}},"collectionConfig":{"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e"]}}
// ]]></script><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.3zcQTeDFlV3HhQwoX8g-gg.js" async></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"30505541d877","versionId":"61efe71b379d","creatorId":"1165a0d0d97e","creator":{"userId":"1165a0d0d97e","name":"Sebastian Heinz","username":"STATWORX","createdAt":1504431622226,"imageId":"1*8lHWKHMXnJJDjMmFaLSFTA.jpeg","backgroundImageId":"","bio":"CEO @ STATWORX. Doing data science, stats and ML for over a decade. Food, wine and cocktail enthusiast. Check our website: https://www.statworx.com","twitterScreenName":"","socialStats":{"userId":"1165a0d0d97e","usersFollowedCount":8,"usersFollowedByCount":1056,"type":"SocialStats"},"social":{"userId":"c76ae1d30db3","targetUserId":"1165a0d0d97e","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"},"homeCollection":{"id":"33272dbbd858","name":"ML Review","slug":"mlreview","tags":["MACHINE LEARNING","DATA SCIENCE","COMPUTER VISION","ARTIFICIAL INTELLIGENCE","DEEP LEARNING"],"creatorId":"dee460aa819a","description":"Highlights from Machine Learning Research, Projects and Learning Materials. From and For ML Scientists, Engineers an Enthusiasts.","shortDescription":"Highlights from Machine Learning Research, Projects and…","image":{"imageId":"1*3yjjoZ--eh8E84rH1xRIhQ.jpeg","filter":"","backgroundSize":"","originalWidth":220,"originalHeight":220,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":7899,"activeAt":1554062532319},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*0ykYC2ubehxNL5XrIIbscg.png","filter":"","backgroundSize":"","originalWidth":602,"originalHeight":271,"strategy":"resample","height":0,"width":0},"twitterUsername":"ML_review","publicEmail":"medium@mlreview.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"ML Review","description":"Machine Learning Research, Projects and Educational Materials.","backgroundImage":{},"logoImage":{"id":"1*7R0qj4qN5BUU0db7IZnbDw@2x.png","originalWidth":253,"originalHeight":271,"alt":"ML Review"},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":3,"layout":4,"number":1,"postIds":["c4f7e148c774"]}},{"type":1,"postListMetadata":{"source":2,"layout":4,"number":2,"postIds":[],"sectionHeader":"Trending"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":2,"postIds":[]}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"223d43d538fc"}},{"type":1,"postListMetadata":{"source":2,"layout":4,"number":5,"postIds":[]}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":2,"postIds":[],"sectionHeader":"Latest"}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"8cde15ec4c7a"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":12,"postIds":[]}}],"tintColor":"#FF2D72D9","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF4487EE","point":0},{"color":"#FF427EDA","point":0.1},{"color":"#FF4074C5","point":0.2},{"color":"#FF3D6BB1","point":0.3},{"color":"#FF3A619E","point":0.4},{"color":"#FF35568A","point":0.5},{"color":"#FF304B77","point":0.6},{"color":"#FF2A4063","point":0.7},{"color":"#FF233550","point":0.8},{"color":"#FF1B283D","point":0.9},{"color":"#FF121B29","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF2D72D9","point":0},{"color":"#FF4883E0","point":0.1},{"color":"#FF5F93E6","point":0.2},{"color":"#FF75A2ED","point":0.3},{"color":"#FF89B1F3","point":0.4},{"color":"#FF9CBFF9","point":0.5},{"color":"#FFAFCDFF","point":0.6},{"color":"#FFC1DAFF","point":0.7},{"color":"#FFD3E7FF","point":0.8},{"color":"#FFE4F4FF","point":0.9},{"color":"#FFF6FFFF","point":1}],"backgroundColor":"#FF2D72D9"},"highlightSpectrum":{"colorPoints":[{"color":"#FFE6F4FF","point":0},{"color":"#FFE2F3FF","point":0.1},{"color":"#FFDDF1FF","point":0.2},{"color":"#FFD8F0FF","point":0.3},{"color":"#FFD3EEFF","point":0.4},{"color":"#FFCEECFF","point":0.5},{"color":"#FFC9EBFF","point":0.6},{"color":"#FFC3E9FF","point":0.7},{"color":"#FFBEE8FF","point":0.8},{"color":"#FFB8E6FF","point":0.9},{"color":"#FFB2E4FF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[{"type":2,"title":"✍️ Contribute","postId":"c814c54ca28d","url":"https://medium.com/mlreview/publish-with-ml-review-c814c54ca28d","source":"postId"},{"type":3,"title":"🔥𝐌𝐋Review.com Newsletter","url":"http://mlreview.com/?medium"}],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"ML Review","description":"Machine Learning Research, Projects and Educational Materials.","backgroundImage":{},"logoImage":{"id":"1*7R0qj4qN5BUU0db7IZnbDw@2x.png","originalWidth":253,"originalHeight":271,"alt":"ML Review"},"alignment":2,"layout":5},"type":"Collection"},"homeCollectionId":"33272dbbd858","title":"A simple deep learning model for stock price prediction using TensorFlow","detectedLanguage":"en","latestVersion":"61efe71b379d","latestPublishedVersion":"61efe71b379d","hasUnpublishedEdits":false,"latestRev":1166,"createdAt":1510075877578,"updatedAt":1539025812449,"acceptedAt":0,"firstPublishedAt":1510240075166,"latestPublishedAt":1539025812449,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"For a recent hackathon that we did at STATWORX, some of our team members scraped minutely S&P 500 data from the Google Finance API. The…","bodyModel":{"paragraphs":[{"name":"6654","type":4,"text":"A typical stock image when you search for stock market prediction ;)","markups":[],"layout":5,"metadata":{"id":"1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg","originalWidth":4608,"originalHeight":3456,"isFeatured":true}},{"name":"d0fa","type":3,"text":"A simple deep learning model for stock price prediction using TensorFlow","markups":[]},{"name":"3d3b","type":1,"text":"For a recent hackathon that we did at STATWORX, some of our team members scraped minutely S&P 500 data from the Google Finance API. The data consisted of index as well as stock prices of the S&P’s 500 constituents. Having this data at hand, the idea of developing a deep learning model for predicting the S&P 500 index based on the 500 constituents prices one minute ago came immediately on my mind.","markups":[{"type":3,"start":38,"end":46,"href":"https://www.statworx.com/de/data-science/","title":"","rel":"noopener","anchorType":0}]},{"name":"6b9f","type":1,"text":"Playing around with the data and building the deep learning model with TensorFlow was fun and so I decided to write my first Medium.com story: a little TensorFlow tutorial on predicting S&P 500 stock prices. What you will read is not an in-depth tutorial, but more a high-level introduction to the important building blocks and concepts of TensorFlow models. The Python code I’ve created is not optimized for efficiency but understandability. The dataset I’ve used can be downloaded from here (40MB).","markups":[{"type":3,"start":488,"end":492,"href":"http://files.statworx.com/sp500.zip","title":"","rel":"noopener","anchorType":0}]},{"name":"4293","type":6,"text":"Note, that this story is a hands-on tutorial on TensorFlow. Actual prediction of stock prices is a really challenging and complex task that requires tremendous efforts, especially at higher frequencies, such as minutes used here.","markups":[]},{"name":"f01e","type":13,"text":"Importing and preparing the data","markups":[]},{"name":"65cc","type":1,"text":"Our team exported the scraped stock data from our scraping server as a csv file. The dataset contains n = 41266 minutes of data ranging from April to August 2017 on 500 stocks as well as the total S&P 500 index price. Index and stocks are arranged in wide format.","markups":[{"type":10,"start":102,"end":111}]},{"name":"23d4","type":8,"text":"# Import data\ndata = pd.read_csv('data_stocks.csv')","markups":[{"type":10,"start":0,"end":51}]},{"name":"3ca9","type":8,"text":"# Drop date variable\ndata = data.drop(['DATE'], 1)","markups":[]},{"name":"9b83","type":8,"text":"# Dimensions of dataset\nn = data.shape[0]\np = data.shape[1]","markups":[{"type":10,"start":0,"end":59}]},{"name":"6707","type":8,"text":"# Make data a numpy array\ndata = data.values","markups":[]},{"name":"a044","type":1,"text":"The data was already cleaned and prepared, meaning missing stock and index prices were LOCF’ed (last observation carried forward), so that the file did not contain any missing values.","markups":[]},{"name":"f896","type":1,"text":"A quick look at the S&P time series using pyplot.plot(data['SP500']):","markups":[{"type":10,"start":42,"end":68}]},{"name":"6913","type":4,"text":"Time series plot of the S&P 500 index.","markups":[],"layout":1,"metadata":{"id":"1*OK6YP4-xG5v8oakDXk2oDw.png"}},{"name":"cd8e","type":6,"text":"Note: This is actually the lead of the S&P 500 index, meaning, its value is shifted 1 minute into the future (this has already been done in the dataset). This operation is necessary since we want to predict the next minute of the index and not the current minute. Technically speaking, each row in the dataset contains the price of the S&P500 at t+1 and the constituent’s prices at T=t.","markups":[]},{"name":"f378","type":13,"text":"Preparing training and test data","markups":[]},{"name":"a38b","type":1,"text":"The dataset was split into training and test data. The training data contained 80% of the total dataset. The data was not shuffled but sequentially sliced. The training data ranges from April to approx. end of July 2017, the test data ends end of August 2017.","markups":[]},{"name":"05c3","type":8,"text":"# Training and test data\ntrain_start = 0\ntrain_end = int(np.floor(0.8*n))\ntest_start = train_end\ntest_end = n\ndata_train = data[np.arange(train_start, train_end), :]\ndata_test = data[np.arange(test_start, test_end), :]","markups":[{"type":10,"start":0,"end":218}]},{"name":"5631","type":1,"text":"There are a lot of different approaches to time series cross validation, such as rolling forecasts with and without refitting or more elaborate concepts such as time series bootstrap resampling. The latter involves repeated samples from the remainder of the seasonal decomposition of the time series in order to simulate samples that follow the same seasonal pattern as the original time series but are not exact copies of its values.","markups":[]},{"name":"1753","type":13,"text":"Data scaling","markups":[]},{"name":"04ab","type":1,"text":"Most neural network architectures benefit from scaling the inputs (sometimes also the output). Why? Because most common activation functions of the network’s neurons such as tanh or sigmoid are defined on the [-1, 1] or [0, 1] interval respectively. Nowadays, rectified linear unit (ReLU) activations are commonly used activations which are unbounded on the axis of possible activation values. However, we will scale both the inputs and targets anyway. Scaling can be easily accomplished in Python using sklearn’s MinMaxScaler.","markups":[{"type":10,"start":209,"end":216},{"type":10,"start":220,"end":226},{"type":10,"start":514,"end":526}]},{"name":"503f","type":8,"text":"# Scale data\nfrom sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\ndata_train = scaler.fit_transform(data_train)\ndata_test = scaler.transform(data_test)","markups":[{"type":10,"start":0,"end":169}]},{"name":"a5ac","type":8,"text":"# Build X and y\nX_train = data_train[:, 1:]\ny_train = data_train[:, 0]\nX_test = data_test[:, 1:]\ny_test = data_test[:, 0]","markups":[{"type":10,"start":0,"end":121}]},{"name":"5df4","type":1,"text":"Remark: Caution must be undertaken regarding what part of the data is scaled and when. A common mistake is to scale the whole dataset before training and test split are being applied. Why is this a mistake? Because scaling invokes the calculation of statistics e.g. the min/max of a variable. When performing time series forecasting in real life, you do not have information from future observations at the time of forecasting. Therefore, calculation of scaling statistics has to be conducted on training data and must then be applied to the test data. Otherwise, you use future information at the time of forecasting which commonly biases forecasting metrics in a positive direction.","markups":[{"type":2,"start":45,"end":49},{"type":2,"start":81,"end":85}]},{"name":"9dd3","type":13,"text":"Introduction to TensorFlow","markups":[]},{"name":"185d","type":1,"text":"TensorFlow is a great piece of software and currently the leading deep learning and neural network computation framework. It is based on a C++ low level backend but is usually controlled via Python (there is also a neat TensorFlow library for R, maintained by RStudio). TensorFlow operates on a graph representation of the underlying computational task. This approach allows the user to specify mathematical operations as elements in a graph of data, variables and operators. Since neural networks are actually graphs of data and mathematical operations, TensorFlow is just perfect for neural networks and deep learning. Check out this simple example (stolen from our deep learning introduction from our blog):","markups":[{"type":10,"start":139,"end":142},{"type":3,"start":220,"end":244,"href":"https://tensorflow.rstudio.com/","title":"","rel":"","anchorType":0},{"type":3,"start":668,"end":694,"href":"https://www.statworx.com/ch/blog/deep-learning-teil-2-programmierung/","title":"","rel":"","anchorType":0}]},{"name":"08b3","type":4,"text":"A very simple graph that adds two numbers together.","markups":[],"layout":1,"metadata":{"id":"1*aCqfu5QVufgPuJNWg4Vn7g.png"}},{"name":"147a","type":1,"text":"In the figure above, two numbers are supposed to be added. Those numbers are stored in two variables, a and b. The two values are flowing through the graph and arrive at the square node, where they are being added. The result of the addition is stored into another variable, c. Actually, a, b and c can be considered as placeholders. Any numbers that are fed into a and b get added and are stored into c. This is exactly how TensorFlow works. The user defines an abstract representation of the model (neural network) through placeholders and variables. Afterwards, the placeholders get \"filled\" with real data and the actual computations take place. The following code implements the toy example from above in TensorFlow:","markups":[{"type":10,"start":102,"end":103},{"type":10,"start":108,"end":109},{"type":10,"start":275,"end":276},{"type":10,"start":288,"end":289},{"type":10,"start":291,"end":292},{"type":10,"start":297,"end":298},{"type":10,"start":364,"end":365},{"type":10,"start":370,"end":371},{"type":10,"start":402,"end":403}]},{"name":"dd3a","type":8,"text":"# Import TensorFlow\nimport tensorflow as tf\n\n# Define a and b as placeholders\na = tf.placeholder(dtype=tf.int8)\nb = tf.placeholder(dtype=tf.int8)\n\n# Define the addition\nc = tf.add(a, b)\n\n# Initialize the graph\ngraph = tf.Session()\n\n# Run the graph\ngraph.run(c, feed_dict={a: 5, b: 4})","markups":[{"type":10,"start":0,"end":284,"href":"","title":"","rel":"","name":"","anchorType":0,"creatorIds":[],"userId":""}]},{"name":"5c17","type":1,"text":"After having imported the TensorFlow library, two placeholders are defined using tf.placeholder(). They correspond to the two blue circles on the left of the image above. Afterwards, the mathematical addition is defined via tf.add(). The result of the computation is c = 9. With placeholders set up, the graph can be executed with any integer value for a and b. Of course, the former problem is just a toy example. The required graphs and computations in a neural network are much more complex.","markups":[{"type":10,"start":81,"end":97},{"type":10,"start":224,"end":232},{"type":10,"start":267,"end":272},{"type":10,"start":353,"end":354},{"type":10,"start":359,"end":360}]},{"name":"de5e","type":13,"text":"Placeholders","markups":[]},{"name":"92fb","type":1,"text":"As mentioned before, it all starts with placeholders. We need two placeholders in order to fit our model: X contains the network's inputs (the stock prices of all S&P 500 constituents at time T = t) and Y the network's outputs (the index value of the S&P 500 at time T = t + 1).","markups":[{"type":10,"start":106,"end":107},{"type":10,"start":192,"end":197},{"type":10,"start":267,"end":276}]},{"name":"ee93","type":1,"text":"The shape of the placeholders correspond to [None, n_stocks] with [None] meaning that the inputs are a 2-dimensional matrix and the outputs are a 1-dimensional vector. It is crucial to understand which input and output dimensions the neural net needs in order to design it properly.","markups":[{"type":10,"start":44,"end":60},{"type":10,"start":66,"end":72}]},{"name":"a78c","type":8,"text":"# Placeholder\nX = tf.placeholder(dtype=tf.float32, shape=[None, n_stocks])\nY = tf.placeholder(dtype=tf.float32, shape=[None])","markups":[{"type":10,"start":0,"end":125}]},{"name":"e7e9","type":1,"text":"The None argument indicates that at this point we do not yet know the number of observations that flow through the neural net graph in each batch, so we keep if flexible. We will later define the variable batch_size that controls the number of observations per training batch.","markups":[{"type":10,"start":4,"end":8},{"type":10,"start":205,"end":215}]},{"name":"5932","type":13,"text":"Variables","markups":[]},{"name":"03ce","type":1,"text":"Besides placeholders, variables are another cornerstone of the TensorFlow universe. While placeholders are used to store input and target data in the graph, variables are used as flexible containers within the graph that are allowed to change during graph execution. Weights and biases are represented as variables in order to adapt during training. Variables need to be initialized, prior to model training. We will get into that a litte later in more detail.","markups":[]},{"name":"c376","type":1,"text":"The model consists of four hidden layers. The first layer contains 1024 neurons, slightly more than double the size of the inputs. Subsequent hidden layers are always half the size of the previous layer, which means 512, 256 and finally 128 neurons. A reduction of the number of neurons for each subsequent layer compresses the information the network identifies in the previous layers. Of course, other network architectures and neuron configurations are possible but are out of scope for this introduction level article.","markups":[]},{"name":"09b5","type":8,"text":"# Model architecture parameters\nn_stocks = 500\nn_neurons_1 = 1024\nn_neurons_2 = 512\nn_neurons_3 = 256\nn_neurons_4 = 128\nn_target = 1","markups":[]},{"name":"f8ea","type":8,"text":"# Layer 1: Variables for hidden weights and biases\nW_hidden_1 = tf.Variable(weight_initializer([n_stocks, n_neurons_1]))\nbias_hidden_1 = tf.Variable(bias_initializer([n_neurons_1]))","markups":[{"type":10,"start":0,"end":181}]},{"name":"3211","type":8,"text":"# Layer 2: Variables for hidden weights and biases\nW_hidden_2 = tf.Variable(weight_initializer([n_neurons_1, n_neurons_2]))\nbias_hidden_2 = tf.Variable(bias_initializer([n_neurons_2]))","markups":[{"type":10,"start":0,"end":184}]},{"name":"4cc0","type":8,"text":"# Layer 3: Variables for hidden weights and biases\nW_hidden_3 = tf.Variable(weight_initializer([n_neurons_2, n_neurons_3]))\nbias_hidden_3 = tf.Variable(bias_initializer([n_neurons_3]))","markups":[{"type":10,"start":0,"end":184}]},{"name":"e087","type":8,"text":"# Layer 4: Variables for hidden weights and biases\nW_hidden_4 = tf.Variable(weight_initializer([n_neurons_3, n_neurons_4]))\nbias_hidden_4 = tf.Variable(bias_initializer([n_neurons_4]))\n\n# Output layer: Variables for output weights and biases\nW_out = tf.Variable(weight_initializer([n_neurons_4, n_target]))\nbias_out = tf.Variable(bias_initializer([n_target]))","markups":[{"type":10,"start":0,"end":359}]},{"name":"e1cf","type":1,"text":"It is important to understand the required variable dimensions between input, hidden and output layers. As a rule of thumb in multilayer perceptrons (MLPs, the type of networks used here), the second dimension of the previous layer is the first dimension in the current layer for weight matrices. This might sound complicated but is essentially just each layer passing its output as input to the next layer. The biases dimension equals the second dimension of the current layer’s weight matrix, which corresponds the number of neurons in this layer.","markups":[]},{"name":"765d","type":13,"text":"Designing the network architecture","markups":[]},{"name":"25ab","type":1,"text":"After definition of the required weight and bias variables, the network topology, the architecture of the network, needs to be specified. Hereby, placeholders (data) and variables (weighs and biases) need to be combined into a system of sequential matrix multiplications.","markups":[]},{"name":"6631","type":1,"text":"Furthermore, the hidden layers of the network are transformed by activation functions. Activation functions are important elements of the network architecture since they introduce non-linearity to the system. There are dozens of possible activation functions out there, one of the most common is the rectified linear unit (ReLU) which will also be used in this model.","markups":[]},{"name":"8da6","type":8,"text":"# Hidden layer\nhidden_1 = tf.nn.relu(tf.add(tf.matmul(X, W_hidden_1), bias_hidden_1))\nhidden_2 = tf.nn.relu(tf.add(tf.matmul(hidden_1, W_hidden_2), bias_hidden_2))\nhidden_3 = tf.nn.relu(tf.add(tf.matmul(hidden_2, W_hidden_3), bias_hidden_3))\nhidden_4 = tf.nn.relu(tf.add(tf.matmul(hidden_3, W_hidden_4), bias_hidden_4))\n\n# Output layer (must be transposed)\nout = tf.transpose(tf.add(tf.matmul(hidden_4, W_out), bias_out))","markups":[{"type":10,"start":0,"end":421}]},{"name":"1020","type":1,"text":"The image below illustrates the network architecture. The model consists of three major building blocks. The input layer, the hidden layers and the output layer. This architecture is called a feedforward network. Feedforward indicates that the batch of data solely flows from left to right. Other network architectures, such as recurrent neural networks, also allow data flowing “backwards” in the network.","markups":[]},{"name":"6564","type":4,"text":"Cool technical illustration of our feedforward network architecture.","markups":[],"layout":1,"metadata":{"id":"1*SHAol6IyUGn5yoXt7mC4Uw.png","originalWidth":1629,"originalHeight":960}},{"name":"9d7e","type":13,"text":"Cost function","markups":[]},{"name":"f6d7","type":1,"text":"The cost function of the network is used to generate a measure of deviation between the network’s predictions and the actual observed training targets. For regression problems, the mean squared error (MSE) function is commonly used. MSE computes the average squared deviation between predictions and targets. Basically, any differentiable function can be implemented in order to compute a deviation measure between predictions and targets.","markups":[]},{"name":"4a52","type":8,"text":"# Cost function\nmse = tf.reduce_mean(tf.squared_difference(out, Y))","markups":[{"type":10,"start":0,"end":67}]},{"name":"6784","type":1,"text":"However, the MSE exhibits certain properties that are advantageous for the general optimization problem to be solved.","markups":[]},{"name":"ebe7","type":13,"text":"Optimizer","markups":[]},{"name":"b294","type":1,"text":"The optimizer takes care of the necessary computations that are used to adapt the network’s weight and bias variables during training. Those computations invoke the calculation of so called gradients, that indicate the direction in which the weights and biases have to be changed during training in order to minimize the network’s cost function. The development of stable and speedy optimizers is a major field in neural network an deep learning research.","markups":[]},{"name":"8003","type":8,"text":"# Optimizer\nopt = tf.train.AdamOptimizer().minimize(mse)","markups":[{"type":10,"start":0,"end":56}]},{"name":"9d4a","type":1,"text":"Here the Adam Optimizer is used, which is one of the current default optimizers in deep learning development. Adam stands for “Adaptive Moment Estimation” and can be considered as a combination between two other popular optimizers AdaGrad and RMSProp.","markups":[{"type":1,"start":127,"end":130},{"type":1,"start":136,"end":137}]},{"name":"1b4f","type":13,"text":"Initializers","markups":[]},{"name":"3d87","type":1,"text":"Initializers are used to initialize the network’s variables before training. Since neural networks are trained using numerical optimization techniques, the starting point of the optimization problem is one the key factors to find good solutions to the underlying problem. There are different initializers available in TensorFlow, each with different initialization approaches. Here, I use the tf.variance_scaling_initializer(), which is one of the default initialization strategies.","markups":[{"type":10,"start":393,"end":426}]},{"name":"2765","type":8,"text":"# Initializers\nsigma = 1\nweight_initializer = tf.variance_scaling_initializer(mode=\"fan_avg\", distribution=\"uniform\", scale=sigma)\nbias_initializer = tf.zeros_initializer()","markups":[{"type":10,"start":0,"end":172}]},{"name":"de81","type":1,"text":"Note, that with TensorFlow it is possible to define multiple initialization functions for different variables within the graph. However, in most cases, a unified initialization is sufficient.","markups":[]},{"name":"793c","type":13,"text":"Fitting the neural network","markups":[]},{"name":"107c","type":1,"text":"After having defined the placeholders, variables, initializers, cost functions and optimizers of the network, the model needs to be trained. Usually, this is done by minibatch training. During minibatch training random data samples of n = batch_size are drawn from the training data and fed into the network. The training dataset gets divided into n / batch_size batches that are sequentially fed into the network. At this point the placeholders X and Y come into play. They store the input and target data and present them to the network as inputs and targets.","markups":[{"type":10,"start":235,"end":249},{"type":10,"start":348,"end":362},{"type":10,"start":446,"end":447},{"type":10,"start":452,"end":453}]},{"name":"2011","type":1,"text":"A sampled data batch of X flows through the network until it reaches the output layer. There, TensorFlow compares the models predictions against the actual observed targets Y in the current batch. Afterwards, TensorFlow conducts an optimization step and updates the networks parameters, corresponding to the selected learning scheme. After having updated the weights and biases, the next batch is sampled and the process repeats itself. The procedure continues until all batches have been presented to the network. One full sweep over all batches is called an epoch.","markups":[{"type":10,"start":24,"end":25},{"type":10,"start":173,"end":174}]},{"name":"2f16","type":1,"text":"The training of the network stops once the maximum number of epochs is reached or another stopping criterion defined by the user applies.","markups":[]},{"name":"c125","type":8,"text":"# Make Session\nnet = tf.Session()","markups":[]},{"name":"a0a9","type":8,"text":"# Run initializer\nnet.run(tf.global_variables_initializer())\n\n# Setup interactive plot\nplt.ion()\nfig = plt.figure()\nax1 = fig.add_subplot(111)\nline1, = ax1.plot(y_test)\nline2, = ax1.plot(y_test*0.5)\nplt.show()\n\n# Number of epochs and batch size\nepochs = 10\nbatch_size = 256\n\nfor e in range(epochs):\n\n    # Shuffle training data\n    shuffle_indices = np.random.permutation(np.arange(len(y_train)))\n    X_train = X_train[shuffle_indices]\n    y_train = y_train[shuffle_indices]\n\n    # Minibatch training\n    for i in range(0, len(y_train) // batch_size):\n        start = i * batch_size\n        batch_x = X_train[start:start + batch_size]\n        batch_y = y_train[start:start + batch_size]\n        # Run optimizer with batch\n        net.run(opt, feed_dict={X: batch_x, Y: batch_y})\n\n        # Show progress\n        if np.mod(i, 5) == 0:\n            # Prediction\n            pred = net.run(out, feed_dict={X: X_test})\n            line2.set_ydata(pred)\n            plt.title('Epoch ' + str(e) + ', Batch ' + str(i))\n            file_name = 'img/epoch_' + str(e) + '_batch_' + str(i) + '.jpg'\n            plt.savefig(file_name)\n            plt.pause(0.01)","markups":[{"type":10,"start":0,"end":275}]},{"name":"488f","type":8,"text":"# Print final MSE after Training\nmse_final = net.run(mse, feed_dict={X: X_test, Y: y_test})\nprint(mse_final)","markups":[]},{"name":"fe39","type":1,"text":"During the training, we evaluate the networks predictions on the test set — the data which is not learned, but set aside — for every 5th batch and visualize it. Additionally, the images are exported to disk and later combined into a video animation of the training process (see below). The model quickly learns the shape and location of the time series in the test data and is able to produce an accurate prediction after some epochs. Nice!","markups":[]},{"name":"2546","type":11,"text":"Video animation of the network’s test data prediction (orange) during training.","markups":[],"layout":1,"iframe":{"mediaResourceId":"3ed7ecd168f27d9dc8c59616d2543bdd","iframeWidth":640,"iframeHeight":480,"thumbnailUrl":"https://i.embed.ly/1/image?url=https%3A%2F%2Fi.ytimg.com%2Fvi%2FI_KMlGavtiQ%2Fhqdefault.jpg&key=a19fcc184b9711e1b4764040d3dc5c07"}},{"name":"fca4","type":1,"text":"One can see that the networks rapidly adapts to the basic shape of the time series and continues to learn finer patterns of the data. This also corresponds to the Adam learning scheme that lowers the learning rate during model training in order not to overshoot the optimization minimum. After 10 epochs, we have a pretty close fit to the test data! The final test MSE equals 0.00078 (it is very low, because the target is scaled). The mean absolute percentage error of the forecast on the test set is equal to 5.31% which is pretty good. Note, that this is just a fit to the test data, no actual out of sample metrics in a real world scenario.","markups":[]},{"name":"2688","type":4,"text":"Scatter plot between predicted and actual S&P prices (scaled).","markups":[],"layout":1,"metadata":{"id":"1*tnbyLo91bfJUexf7TnJamA.png","originalWidth":724,"originalHeight":622}},{"name":"11b6","type":1,"text":"Please note that there are tons of ways of further improving this result: design of layers and neurons, choosing different initialization and activation schemes, introduction of dropout layers of neurons, early stopping and so on. Furthermore, different types of deep learning models, such as recurrent neural networks might achieve better performance on this task. However, this is not the scope of this introductory post.","markups":[]},{"name":"6a5a","type":13,"text":"Conclusion and outlook","markups":[]},{"name":"cc16","type":1,"text":"The release of TensorFlow was a landmark event in deep learning research. Its flexibility and performance allows researchers to develop all kinds of sophisticated neural network architectures as well as other ML algorithms. However, flexibility comes at the cost of longer time-to-model cycles compared to higher level APIs such as Keras or MxNet. Nonetheless, I am sure that TensorFlow will make its way to the de-facto standard in neural network and deep learning development in research and practical applications. Many of our customers are already using TensorFlow or start developing projects that employ TensorFlow models. Also our data science consultants at STATWORX are heavily using TensorFlow for deep learning and neural net research and development. Let’s see what Google has planned for the future of TensorFlow. One thing that is missing, at least in my opinion, is a neat graphical user interface for designing and developing neural net architectures with TensorFlow backend. Maybe, this is something Google is already working on ;)","markups":[{"type":3,"start":332,"end":337,"href":"https://keras.io/","title":"","rel":"","anchorType":0},{"type":3,"start":341,"end":346,"href":"https://mxnet.incubator.apache.org/","title":"","rel":"","anchorType":0},{"type":3,"start":638,"end":662,"href":"https://www.statworx.com/de/data-science/","title":"","rel":"","anchorType":0}]},{"name":"2e63","type":1,"text":"Update: I’ve added both the Python script as well as a (zipped) dataset to a Github repository. Feel free to clone and fork.","markups":[{"type":3,"start":77,"end":94,"href":"https://github.com/sebastianheinz/stockprediction","title":"","rel":"noopener","anchorType":0},{"type":1,"start":0,"end":7}]},{"name":"5db2","type":3,"text":"Final remarks","markups":[]},{"name":"8a22","type":1,"text":"If you have any comments or questions on my story, feel free to comment below! I will try to answer them. Also, feel free to use my code or share this story with your peers on social platforms of your choice. Follow me on LinkedIn or Twitter, if you want to stay in touch.","markups":[{"type":3,"start":222,"end":230,"href":"https://www.linkedin.com/in/sebastian-heinz-90885272/","title":"","rel":"noopener","anchorType":0},{"type":3,"start":234,"end":241,"href":"https://twitter.com/statworx","title":"","rel":"noopener","anchorType":0}]},{"name":"7985","type":1,"text":"Make sure, you also check the awesome STATWORX Blog for more interesting data science, ML and AI content straight from the our office in Frankfurt, Germany!","markups":[{"type":3,"start":38,"end":51,"href":"https://www.statworx.com/de/blog","title":"","rel":"noopener","anchorType":0}]},{"name":"840a","type":1,"text":"If you’re interested in more quality content like this, join my mailing list, constantly bringing you new data science, machine learning and AI reads and treats from me and my team right into your inbox!","markups":[]},{"name":"efec","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"e406f5720750ce3590e4050d11d8501a","iframeWidth":800,"iframeHeight":400}},{"name":"22e4","type":1,"text":"I hope you liked my story, I really enjoyed writing it. Thank you for your time!","markups":[]}],"sections":[{"name":"acc5","startIndex":0}]},"postDisplay":{"coverless":true}},"virtuals":{"statusForCollection":"APPROVED","allowNotes":true,"previewImage":{"imageId":"1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg","filter":"","backgroundSize":"","originalWidth":4608,"originalHeight":3456,"strategy":"resample","height":0,"width":0},"wordCount":3098,"imageCount":5,"readingTime":12.523899371069183,"subtitle":"For a recent hackathon that we did at STATWORX, some of our team members scraped minutely S&P 500 data from the Google Finance API. The…","publishedInCount":1,"usersBySocialRecommends":[],"noIndex":false,"recommends":1199,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"machine-learning","name":"Machine Learning","postCount":70359,"metadata":{"postCount":70359,"coverImage":{"id":"0*iNI8Oc80Eunm8NgI","originalWidth":1532,"originalHeight":832,"isFeatured":true}},"type":"Tag"},{"slug":"deep-learning","name":"Deep Learning","postCount":17354,"metadata":{"postCount":17354,"coverImage":{"id":"0*iNI8Oc80Eunm8NgI","originalWidth":1532,"originalHeight":832,"isFeatured":true}},"type":"Tag"},{"slug":"tensorflow","name":"TensorFlow","postCount":3623,"metadata":{"postCount":3623,"coverImage":{"id":"0*iNI8Oc80Eunm8NgI","originalWidth":1532,"originalHeight":832,"isFeatured":true}},"type":"Tag"},{"slug":"stock-market","name":"Stock Market","postCount":17734,"metadata":{"postCount":17734,"coverImage":{"id":"1*s0LEa5OWrhcpKyNj6rxb2w.jpeg","originalWidth":2000,"originalHeight":1333,"isFeatured":true}},"type":"Tag"},{"slug":"tutorial","name":"Tutorial","postCount":14303,"metadata":{"postCount":14303,"coverImage":{"id":"1*O7oqV37UCXXe9SS8Lelsyg.jpeg","originalWidth":1280,"originalHeight":522,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":78,"links":{"entries":[{"url":"https://tensorflow.rstudio.com/","alts":[],"httpStatus":200},{"url":"https://keras.io/","alts":[],"httpStatus":200},{"url":"https://www.linkedin.com/in/sebastian-heinz-90885272/","alts":[],"httpStatus":999},{"url":"https://github.com/sebastianheinz/stockprediction","alts":[],"httpStatus":200},{"url":"https://twitter.com/statworx","alts":[{"type":2,"url":"twitter://user?screen_name=statworx"},{"type":3,"url":"twitter://user?screen_name=statworx"}],"httpStatus":200},{"url":"https://mxnet.incubator.apache.org/","alts":[],"httpStatus":200},{"url":"https://www.statworx.com/de/blog","alts":[],"httpStatus":200},{"url":"https://www.statworx.com/ch/blog/deep-learning-teil-2-programmierung/","alts":[],"httpStatus":200},{"url":"https://www.statworx.com/de/data-science/","alts":[],"httpStatus":200},{"url":"http://files.statworx.com/sp500.zip","alts":[],"httpStatus":0}],"version":"0.3","generatedAt":1539025823064},"isLockedPreviewOnly":false,"metaDescription":"","totalClapCount":7200,"sectionCount":1,"readingList":0,"topics":[]},"coverless":true,"slug":"a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":true,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*NG0bzk0wtQcBdMYAnXKeBQ.jpeg","originalWidth":4608,"originalHeight":3456,"isFeatured":true}},{"name":"d0fa","type":3,"text":"A simple deep learning model for stock price prediction using TensorFlow","markups":[],"alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false,"subtitle":"For a recent hackathon that we did at STATWORX, some of our team members scraped minutely S&P 500 data from the Google Finance API. The…"},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877","approvedHomeCollectionId":"33272dbbd858","approvedHomeCollection":{"id":"33272dbbd858","name":"ML Review","slug":"mlreview","tags":["MACHINE LEARNING","DATA SCIENCE","COMPUTER VISION","ARTIFICIAL INTELLIGENCE","DEEP LEARNING"],"creatorId":"dee460aa819a","description":"Highlights from Machine Learning Research, Projects and Learning Materials. From and For ML Scientists, Engineers an Enthusiasts.","shortDescription":"Highlights from Machine Learning Research, Projects and…","image":{"imageId":"1*3yjjoZ--eh8E84rH1xRIhQ.jpeg","filter":"","backgroundSize":"","originalWidth":220,"originalHeight":220,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":7899,"activeAt":1554062532319},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*0ykYC2ubehxNL5XrIIbscg.png","filter":"","backgroundSize":"","originalWidth":602,"originalHeight":271,"strategy":"resample","height":0,"width":0},"twitterUsername":"ML_review","publicEmail":"medium@mlreview.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"ML Review","description":"Machine Learning Research, Projects and Educational Materials.","backgroundImage":{},"logoImage":{"id":"1*7R0qj4qN5BUU0db7IZnbDw@2x.png","originalWidth":253,"originalHeight":271,"alt":"ML Review"},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":3,"layout":4,"number":1,"postIds":["c4f7e148c774"]}},{"type":1,"postListMetadata":{"source":2,"layout":4,"number":2,"postIds":[],"sectionHeader":"Trending"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":2,"postIds":[]}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"223d43d538fc"}},{"type":1,"postListMetadata":{"source":2,"layout":4,"number":5,"postIds":[]}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":2,"postIds":[],"sectionHeader":"Latest"}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"8cde15ec4c7a"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":12,"postIds":[]}}],"tintColor":"#FF2D72D9","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF4487EE","point":0},{"color":"#FF427EDA","point":0.1},{"color":"#FF4074C5","point":0.2},{"color":"#FF3D6BB1","point":0.3},{"color":"#FF3A619E","point":0.4},{"color":"#FF35568A","point":0.5},{"color":"#FF304B77","point":0.6},{"color":"#FF2A4063","point":0.7},{"color":"#FF233550","point":0.8},{"color":"#FF1B283D","point":0.9},{"color":"#FF121B29","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF2D72D9","point":0},{"color":"#FF4883E0","point":0.1},{"color":"#FF5F93E6","point":0.2},{"color":"#FF75A2ED","point":0.3},{"color":"#FF89B1F3","point":0.4},{"color":"#FF9CBFF9","point":0.5},{"color":"#FFAFCDFF","point":0.6},{"color":"#FFC1DAFF","point":0.7},{"color":"#FFD3E7FF","point":0.8},{"color":"#FFE4F4FF","point":0.9},{"color":"#FFF6FFFF","point":1}],"backgroundColor":"#FF2D72D9"},"highlightSpectrum":{"colorPoints":[{"color":"#FFE6F4FF","point":0},{"color":"#FFE2F3FF","point":0.1},{"color":"#FFDDF1FF","point":0.2},{"color":"#FFD8F0FF","point":0.3},{"color":"#FFD3EEFF","point":0.4},{"color":"#FFCEECFF","point":0.5},{"color":"#FFC9EBFF","point":0.6},{"color":"#FFC3E9FF","point":0.7},{"color":"#FFBEE8FF","point":0.8},{"color":"#FFB8E6FF","point":0.9},{"color":"#FFB2E4FF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[{"type":2,"title":"✍️ Contribute","postId":"c814c54ca28d","url":"https://medium.com/mlreview/publish-with-ml-review-c814c54ca28d","source":"postId"},{"type":3,"title":"🔥𝐌𝐋Review.com Newsletter","url":"http://mlreview.com/?medium"}],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"ML Review","description":"Machine Learning Research, Projects and Educational Materials.","backgroundImage":{},"logoImage":{"id":"1*7R0qj4qN5BUU0db7IZnbDw@2x.png","originalWidth":253,"originalHeight":271,"alt":"ML Review"},"alignment":2,"layout":5},"type":"Collection"},"newsletterId":"","webCanonicalUrl":"https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877","mediumUrl":"https://medium.com/mlreview/a-simple-deep-learning-model-for-stock-price-prediction-using-tensorflow-30505541d877","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"audioVersionDurationSec":0,"sequenceId":"","isNsfw":false,"isEligibleForRevenue":false,"isBlockedFromHightower":false,"deletedAt":0,"lockedPostSource":0,"hightowerMinimumGuaranteeStartsAt":0,"hightowerMinimumGuaranteeEndsAt":0,"featureLockRequestAcceptedAt":0,"mongerRequestType":1,"layerCake":4,"socialTitle":"","socialDek":"","editorialPreviewTitle":"","editorialPreviewDek":"","curationEligibleAt":0,"type":"Post"},"mentionedUsers":[],"collaborators":[],"hideMeter":false,"collectionUserRelations":[],"mode":null,"references":{"User":{"1165a0d0d97e":{"userId":"1165a0d0d97e","name":"Sebastian Heinz","username":"STATWORX","createdAt":1504431622226,"imageId":"1*8lHWKHMXnJJDjMmFaLSFTA.jpeg","backgroundImageId":"","bio":"CEO @ STATWORX. Doing data science, stats and ML for over a decade. Food, wine and cocktail enthusiast. Check our website: https://www.statworx.com","twitterScreenName":"","socialStats":{"userId":"1165a0d0d97e","usersFollowedCount":8,"usersFollowedByCount":1056,"type":"SocialStats"},"social":{"userId":"c76ae1d30db3","targetUserId":"1165a0d0d97e","type":"Social"},"facebookAccountId":"","allowNotes":1,"mediumMemberAt":0,"isNsfw":false,"isWriterProgramEnrolled":true,"isQuarantined":false,"type":"User"}},"Collection":{"33272dbbd858":{"id":"33272dbbd858","name":"ML Review","slug":"mlreview","tags":["MACHINE LEARNING","DATA SCIENCE","COMPUTER VISION","ARTIFICIAL INTELLIGENCE","DEEP LEARNING"],"creatorId":"dee460aa819a","description":"Highlights from Machine Learning Research, Projects and Learning Materials. From and For ML Scientists, Engineers an Enthusiasts.","shortDescription":"Highlights from Machine Learning Research, Projects and…","image":{"imageId":"1*3yjjoZ--eh8E84rH1xRIhQ.jpeg","filter":"","backgroundSize":"","originalWidth":220,"originalHeight":220,"strategy":"resample","height":0,"width":0},"metadata":{"followerCount":7899,"activeAt":1554062532319},"virtuals":{"permissions":{"canPublish":false,"canPublishAll":false,"canRepublish":false,"canRemove":false,"canManageAll":false,"canSubmit":false,"canEditPosts":false,"canAddWriters":false,"canViewStats":false,"canSendNewsletter":false,"canViewLockedPosts":false,"canViewCloaked":false,"canEditOwnPosts":false,"canBeAssignedAuthor":false,"canEnrollInHightower":false,"canLockPostsForMediumMembers":false,"canLockOwnPostsForMediumMembers":false},"isSubscribed":false,"isNewsletterSubscribed":false,"isEnrolledInHightower":false,"isEligibleForHightower":false},"logo":{"imageId":"1*0ykYC2ubehxNL5XrIIbscg.png","filter":"","backgroundSize":"","originalWidth":602,"originalHeight":271,"strategy":"resample","height":0,"width":0},"twitterUsername":"ML_review","publicEmail":"medium@mlreview.com","sections":[{"type":2,"collectionHeaderMetadata":{"title":"ML Review","description":"Machine Learning Research, Projects and Educational Materials.","backgroundImage":{},"logoImage":{"id":"1*7R0qj4qN5BUU0db7IZnbDw@2x.png","originalWidth":253,"originalHeight":271,"alt":"ML Review"},"alignment":2,"layout":5}},{"type":1,"postListMetadata":{"source":3,"layout":4,"number":1,"postIds":["c4f7e148c774"]}},{"type":1,"postListMetadata":{"source":2,"layout":4,"number":2,"postIds":[],"sectionHeader":"Trending"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":2,"postIds":[]}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"223d43d538fc"}},{"type":1,"postListMetadata":{"source":2,"layout":4,"number":5,"postIds":[]}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":2,"postIds":[],"sectionHeader":"Latest"}},{"type":3,"promoMetadata":{"sectionHeader":"","promoId":"8cde15ec4c7a"}},{"type":1,"postListMetadata":{"source":1,"layout":4,"number":12,"postIds":[]}}],"tintColor":"#FF2D72D9","lightText":true,"favicon":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"colorPalette":{"defaultBackgroundSpectrum":{"colorPoints":[{"color":"#FF4487EE","point":0},{"color":"#FF427EDA","point":0.1},{"color":"#FF4074C5","point":0.2},{"color":"#FF3D6BB1","point":0.3},{"color":"#FF3A619E","point":0.4},{"color":"#FF35568A","point":0.5},{"color":"#FF304B77","point":0.6},{"color":"#FF2A4063","point":0.7},{"color":"#FF233550","point":0.8},{"color":"#FF1B283D","point":0.9},{"color":"#FF121B29","point":1}],"backgroundColor":"#FFFFFFFF"},"tintBackgroundSpectrum":{"colorPoints":[{"color":"#FF2D72D9","point":0},{"color":"#FF4883E0","point":0.1},{"color":"#FF5F93E6","point":0.2},{"color":"#FF75A2ED","point":0.3},{"color":"#FF89B1F3","point":0.4},{"color":"#FF9CBFF9","point":0.5},{"color":"#FFAFCDFF","point":0.6},{"color":"#FFC1DAFF","point":0.7},{"color":"#FFD3E7FF","point":0.8},{"color":"#FFE4F4FF","point":0.9},{"color":"#FFF6FFFF","point":1}],"backgroundColor":"#FF2D72D9"},"highlightSpectrum":{"colorPoints":[{"color":"#FFE6F4FF","point":0},{"color":"#FFE2F3FF","point":0.1},{"color":"#FFDDF1FF","point":0.2},{"color":"#FFD8F0FF","point":0.3},{"color":"#FFD3EEFF","point":0.4},{"color":"#FFCEECFF","point":0.5},{"color":"#FFC9EBFF","point":0.6},{"color":"#FFC3E9FF","point":0.7},{"color":"#FFBEE8FF","point":0.8},{"color":"#FFB8E6FF","point":0.9},{"color":"#FFB2E4FF","point":1}],"backgroundColor":"#FFFFFFFF"}},"navItems":[{"type":2,"title":"✍️ Contribute","postId":"c814c54ca28d","url":"https://medium.com/mlreview/publish-with-ml-review-c814c54ca28d","source":"postId"},{"type":3,"title":"🔥𝐌𝐋Review.com Newsletter","url":"http://mlreview.com/?medium"}],"colorBehavior":2,"instantArticlesState":0,"acceleratedMobilePagesState":0,"ampLogo":{"imageId":"","filter":"","backgroundSize":"","originalWidth":0,"originalHeight":0,"strategy":"resample","height":0,"width":0},"header":{"title":"ML Review","description":"Machine Learning Research, Projects and Educational Materials.","backgroundImage":{},"logoImage":{"id":"1*7R0qj4qN5BUU0db7IZnbDw@2x.png","originalWidth":253,"originalHeight":271,"alt":"ML Review"},"alignment":2,"layout":5},"type":"Collection"}},"Social":{"1165a0d0d97e":{"userId":"c76ae1d30db3","targetUserId":"1165a0d0d97e","type":"Social"}},"SocialStats":{"1165a0d0d97e":{"userId":"1165a0d0d97e","usersFollowedCount":8,"usersFollowedByCount":1056,"type":"SocialStats"}}}})
// ]]></script><script>window.PARSELY = window.PARSELY || { autotrack: false }</script><script id="parsely-cfg" src="//d1z2jf7jlzjs58.cloudfront.net/keys/medium.com/p.js"></script><script type="text/javascript">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0); branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled':  false }, function(err, data) {});</script></body></html>